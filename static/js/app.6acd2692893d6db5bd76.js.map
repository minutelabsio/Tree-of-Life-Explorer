{"version":3,"sources":["webpack:///./src/lib/pubsub.js","webpack:///src/components/collage.vue","webpack:///./src/components/collage.vue?4b64","webpack:///./src/components/collage.vue","webpack:///src/components/tol-leaf-view/leaf-view-menu.vue","webpack:///./src/components/tol-leaf-view/leaf-view-menu.vue?84a2","webpack:///./src/components/tol-leaf-view/leaf-view-menu.vue","webpack:///./src/lib/cacher.js","webpack:///./src/lib/otol.js","webpack:///./src/lib/gbif.js","webpack:///./src/lib/throttler.js","webpack:///./src/lib/wikidata.js","webpack:///./src/lib/wikimedia.js","webpack:///./src/lib/image-blacklist.js","webpack:///./src/lib/image-overrides.js","webpack:///./src/lib/taxonomy.js","webpack:///./src/lib/utils.js","webpack:///src/components/taxonomy-info-window.vue","webpack:///./src/components/taxonomy-info-window.vue?ff08","webpack:///./src/components/taxonomy-info-window.vue","webpack:///src/components/tol-leaf-view/index.vue","webpack:///./src/components/tol-leaf-view/index.vue?7442","webpack:///./src/components/tol-leaf-view/index.vue","webpack:///src/components/tol-mrca-view/index.vue","webpack:///./src/components/tol-mrca-view/index.vue?6ae9","webpack:///./src/components/tol-mrca-view/index.vue","webpack:///./src/components/tree/node.vue","webpack:///src/components/tree/node.vue","webpack:///src/components/tree/ancestor-collapse.vue","webpack:///./src/components/tree/ancestor-collapse.vue","webpack:///src/components/tree/condensed-node.vue","webpack:///./src/components/tree/condensed-node.vue","webpack:///./src/components/tree/tail.vue","webpack:///src/components/tree/tail.vue","webpack:///./src/components/tree/connection.vue","webpack:///src/components/tree/connection.vue","webpack:///src/components/tree/child-menu.vue","webpack:///./src/components/tree/child-menu.vue?4218","webpack:///./src/components/tree/child-menu.vue","webpack:///src/components/tree/tree-display.vue","webpack:///./src/components/tree/tree-display.vue?be86","webpack:///./src/components/tree/tree-display.vue","webpack:///src/components/tree/tree-canvas.vue","webpack:///./src/components/tree/tree-canvas.vue?88f4","webpack:///./src/components/tree/tree-canvas.vue","webpack:///./src/lib/tree-utils.js","webpack:///src/components/tol-tree.vue","webpack:///./src/components/tol-tree.vue?1e5e","webpack:///./src/components/tol-tree.vue","webpack:///src/components/tol-common-name-search.vue","webpack:///./src/components/tol-common-name-search.vue?677a","webpack:///./src/components/tol-common-name-search.vue","webpack:///src/components/tol-suggested-trees.vue","webpack:///./src/components/tol-suggested-trees.vue?532a","webpack:///./src/components/tol-suggested-trees.vue","webpack:///./src/lib/fullscreen.js","webpack:///src/pages/tol.vue","webpack:///./src/pages/tol.vue?c60c","webpack:///./src/pages/tol.vue","webpack:///./src/router/index.js","webpack:///src/app.vue","webpack:///./src/app.vue?1d3a","webpack:///./src/app.vue","webpack:///./src/plugins/filters.js","webpack:///./src/main.js"],"names":["pubsub","Vue","collage","name","props","images","Array","data","computed","useCollage","this","length","components","methods","components_collage","render","_h","$createElement","_c","_self","staticClass","_e","attrs","src","_l","image","staticRenderFns","src_components_collage","__webpack_require__","normalizeComponent","ssrContext","leaf_view_menu","commonName","String","flapStyle","Boolean","scientificName","shortScientificName","truncateLength","type","Number","default","backgroundStyle","Collage","tol_leaf_view_leaf_view_menu","_vm","label","_f","active","_v","_s","_t","class","darken","components_tol_leaf_view_leaf_view_menu","leaf_view_menu_normalizeComponent","isExpired","entry","expires","Date","now","cacher","fn","lifetime","arguments","undefined","cache","window","setInterval","keys","keys_default","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","get_iterator_default","next","done","k","value","err","return","clean","_len","args","_key","key","stringify_default","getKey","cachedResult","getCached","Promise","resolve","result","then","cacheResult","BADFLAGS","otol","axios","create","baseURL","timeout","crossdomain","getNode","id","_data","_startsWith","idOrArray","match","node_ids","post","res","mrca","all","map","taxon","getDescendantNames","node_id","childrenNames","join","spread","nodes","lineage","lineages","n","concat","forEach","l","reverse","longest","_sortBy","pop","common","_takeWhile","p","idx","_every","getCommonLineage","getMRCA","idField","defineProperty_default","catch","reject","Error","tap","response_for_mrca_of_broken_taxon","console","error","getTxResultsByNames","names","_castArray","results","matches","_reject","el","_some","_get","f","indexOf","r","getNodeByName","_find","ott_id","getSubtree","source","source_id","_data2","depth","arguson","children","_data3","descendant_name_list","getTxnSourceId","node","str","tax_sources","x","replace","langs","setupCache","maxAge","req","url","params","exclude","query","gbif","adapter","paramsSerializer","options","isParamTypeObject","typeof_default","isParamTypeArray","element","slice","parseParams","setVernacularNames","vernacularNames","vernacularName","push","language","vernacularNameList","filter","_flow","_startCase","_uniq","extends_default","findByScientificName","q","qField","status","dataset_key","d","Throttler","delay","batchSize","classCallCheck_default","count","arg","_this","Math","floor","wikidata","headers","Accept","throttler","findInfoBy","_ref4","ncbiId","_ref5","limit","lang","_ref","sparqlQuery","encodeURIComponent","findInfoByNcbiId","_ref2","findInfoByScientificName","interceptors","request","use","config","schedule","response","fromCache","_response$data","vars","head","bindings","item","assign_default","itemId","m","getItemId","_mapValues","_pick","singleProps","items","_groupBy","_values","parts","_transform","part","_omit","assembleByItem","dir","wikimedia","mapImageResults","page","imageinfo","val","pageid","findImagesByName","thumbSize","action","prop","generator","gsrsearch","format","origin","iiprop","iiurlwidth","title","image_blacklist","image_overrides","ott335582","pic","thumbnail","ott517942","ott568878","ott1007058","ott352914","ott698424","ott186816","ott417957","ott541924","ott770309","ott770315","ott563166","ott763018","ott532127","ott78477","ott1005907","ott244265","ott802117","ott510761","ott510762","ott490099","ott312031","ott417969","gbifMapping","nubKey","nameKey","taxonID","sourceTaxonKey","kingdom","phylum","kingdomKey","phylumKey","datasetKey","constituentKey","parentKey","parent","canonicalName","authorship","nameType","rank","taxonomicStatus","nomenclaturalStatus","remarks","numDescendants","lastCrawled","lastInterpreted","issues","synonym","getMapping","mapping","reduce","obj","toLowerCase","getTaxonomyInfo","types","queries","txnInfoQueries","resultList","_union","txn","unique_name","ensureVernacularNames","toHTTPS","applyImageOverrides","leaf","override","imageOverrides","getImagesAndCommonNames","firstResult","first","second","_indexOf","imageBlacklist","thumbnails","getAllImages","isMRCA","getTxnInfo","coroutine","regenerator_default","a","mark","_callee","wrap","_context","prev","getLeaf","sent","split","abrupt","_mergeWith","toConsumableArray_default","objValue","srcValue","_isArray","txnInfo","imgNameData","stop","Leaf","copyToClipboard","document","createElement","setAttribute","style","position","left","body","appendChild","select","execCommand","removeChild","taxonomy_info_window","Object","currentPic","swiperOptions","navigation","nextEl","prevEl","pagination","isTouch","documentElement","otherCommonNames","taxonomy_isMRCA","rankLink","links","gbifId","remove_default","text","nextImage","len","prevImage","$toast","open","message","utils_copyToClipboard","components_taxonomy_info_window","on","click","$event","href","target","img","slot","icon","link","src_components_taxonomy_info_window","taxonomy_info_window_normalizeComponent","titleCase","w","capitalize_default","shortName","words","out","i","word","tol_leaf_view","LeafViewMenu","filters","txnImages","pin","expanded","loading","hovering","watch","handler","info","nImages","_nImages","$emit","immediate","isAddedToTree","childIsAdded","child","$route","ids","_this2","otol_getSubtree","e","openInfoWindow","$modal","component","hasModalCard","show","hide","startTimer","_this3","timer","setTimeout","clearTimer","clearTimeout","onTouch","preventDefault","stopImmediatePropagation","onMouseLeave","onMouseEnter","_this4","components_tol_leaf_view","flap-style","horizontal","vertical","data-ott","mousedown","stopPropagation","mouseleave","mouseenter","!touchstart","size","mobile-modal","active-change","nativeOn","wheel","is-full-page","has-text-grey-light","common-name","scientific-name","short-scientific-name","truncate-length","hideImages","touchstart","src_components_tol_leaf_view","tol_leaf_view_normalizeComponent","tol_mrca_view","leafData","finally","components_tol_mrca_view","src_components_tol_mrca_view","tol_mrca_view_normalizeComponent","components_tree_node","node_normalizeComponent","inject","mixins","beforeDestroy","off","remove","beforeMount","scene","svg","group","addClass","move","rect","center","radius","plain","tree","attr","subtree","y","h","front","ancestor_collapse","dots","drawDots","clear","circle","width","removeClass","tree_ancestor_collapse","ancestor_collapse_normalizeComponent","condensed_node","tree_condensed_node","condensed_node_normalizeComponent","tree_tail","tail_normalizeComponent","tail","tree_connection","connection_normalizeComponent","polyline","plot","spacing","padding","x1","y1","x2","y2","line","back","child_menu","tree_child_menu","is-active","transform","components_tree_child_menu","child_menu_normalizeComponent","getColumns","columns","fill","appendToColumns","colOffset","level","colIndex","nTips","isRoot","hasSplit","tree_display","px","py","cardWidth","cardHeight","branchSpacing","hide-images","computedBranches","compactView","transitions","subtreeLeaf","childMenuX","childMenuY","Connection","ChildMenu","Node","AncestorCollapse","CondensedNode","Tail","TOLLeafView","TOLMRCAView","created","addEventListener","onDocumentClick","destroyed","removeEventListener","branches","b","getBranches","opts","hz","height","nodeContainerSize","colstart","dx","dy","flatten_default","xpos","ypos","col","openChildMenu","tree_tree_display","branch","top","tabindex","css","cut","add-node","remove-node","components_tree_tree_display","tree_display_normalizeComponent","clamp","v","min","max","requestAnimationFrame","animate","time","Tween_default","update","tree_canvas","offsetX","offsetY","panDuration","elWidth","elHeight","provide","svgEl","svg_default","mounted","$refs","impetus","impetus_default","$el","cancelPan","setOffset","onResize","debounce_default","setBoundX","xBounds","setBoundY","yBounds","onWheel","contains","_getClampedCoords","getClampedCoords","deltaX","deltaY","setValues","passive","$watch","$once","destroy","fixSVGPosition","_xBounds","slicedToArray_default","minX","maxX","_yBounds","minY","maxY","offsetWidth","offsetHeight","panTo","coords","_getClampedCoords2","_activeTween","Tween","to","easing","Easing","Quadratic","InOut","onUpdate","start","tree_tree_canvas","ref","components_tree_tree_canvas","tree_canvas_normalizeComponent","toBranch","splitAt","_clone","mergeAt","splice","shift","joinTree","treeParent","branchParent","stem","isInStem","tipsAdded","treeSort","sort","buildReducedTree","leafs","assignDepth","tol_tree","Tree","TreeCanvas","leafContext","openLeafContext","leafContextX","leafContextY","outerPadding","canvasX","$on","nodeId","$nextTick","$off","newVal","oldVal","centerTree","newLeafs","differenceBy_default","showLeafDetails","zoomTo","$router","c","find_default","treeCanvas","clientWidth","clientHeight","components_tol_tree","appear","offset-x","offset-y","has-text-grey","update:computedBranches","update:computed-branches","leaf-click","zoom-in","src_components_tol_tree","tol_tree_normalizeComponent","filterByOTLMatches","otlMatches","otlNames","removeDuplicates","uniqBy_default","removeLackingVernacularName","reject_default","tol_common_name_search","scientificResults","searchEntry","isFetching","isFetchingSci","overlayOpen","openOverlay","overflow","overlayInput","focus","closeOverlay","search","trim","execSearch","searchGbif","searchWikidata","errorMsg","findByCommonName","commonNames","findInfoByCommonName","selectResult","duration","components_tol_common_name_search","keyup","_k","keyCode","directives","rawName","expression","placeholder","model","callback","$$v","input","src_components_tol_common_name_search","tol_common_name_search_normalizeComponent","suggestions","desc","ottIds","tol_suggested_trees","suggest","components_tol_suggested_trees","_m","sug","domProps","innerHTML","src_components_tol_suggested_trees","tol_suggested_trees_normalizeComponent","docEl","canFullscreen","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","fullscreenEventName","tol","wideMode","horizontalMode","TOLTree","TOLCommonNameSearch","TOLSuggestedTrees","navOpen","isInFullscreen","tourMessage","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","treeIsEmpty","oldIds","onIdsChanged","$snackbar","actionText","onError","showError","queue","undo","redo","forward","setLeafs","uniq_default","addLeaf","castArray_default","filter_default","startsWith_default","union_default","removeLeaf","difference_default","onRemoveLeaf","onSelect","cutBranch","getChildren","ch","addNode","bluebird_default","showMetaInfo","$root","menuToggle","fullscreenToggle","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","setOption","share","location","startTour","pages_tol","nav-open","grouped","data-v-tour","pulsing","card-width","pack","src_pages_tol","tol_normalizeComponent","getOption","def","parseInt","Router","router","routes","path","PageTOL","route","_compact","txnCats","TourTree","TourSteps","content","onEnter","querySelector","classList","add","placement","onLeave","TourCallbacks","onStart","execStepCallbacks","step","currentStep","onPreviousStep","current","onNextStep","onStop","app","throttle_default","$tours","$children","createStep","selectortype_template_index_0_src_app","steps","callbacks","src_app","app_normalizeComponent","_capitalize","numberRanges","range","suffix","decimals","Infinity","shortNumber","cfg","toFixed","truncate","sfx","substr","install","_filter","Buefy","defaultContainerElement","Filters","VueMotion","VueTour","VueAwesomeSwiper","productionTip","html","MetaInfoComponent","template","getElementById","parentNode","showInfo","get","set","App"],"mappings":"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AAA,WAA8BI,OAAOiB,KAAA,OAAA8uB,YAAA,kBAAAvW,KAAA,WAA+DP,IAAKkX,MAAA5uB,EAAAstB,QAAmBnR,UAAW+R,MAAA,SAAAtW,GAAyB,OAAA5X,EAAAitB,YAAArV,KAAgC6W,OAAQtsB,MAAAnC,EAAA,YAAA0uB,SAAA,SAAAC,GAAiD3uB,EAAA6sB,YAAA8B,GAAoBJ,WAAA,iBAA2BlwB,EAAA,OAAYE,YAAA,YAAsBF,EAAA,OAAYE,YAAA,SAAAmZ,IAAyBC,MAAA3X,EAAAitB,eAAyB5uB,EAAA,QAAA2B,EAAAI,GAAA,6BAEv3FvB,oBCChC,IAuBegwB,GAvBU9vB,EAAQ,OAcjB+vB,CACdnC,GACAsB,IAT6B,EAV/B,SAAoBhvB,GAClBF,EAAQ,SAaS,kBAEU,MAUG,QCJhCgwB,KAEAjgB,MAAA,mBACAlQ,MAAA,kIACAowB,KAAA,8RACAC,QACA,YACA,YACA,aACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,eAIAngB,MAAA,gBACAlQ,MAAA,4EACAowB,KAAA,iDACAC,QACA,YACA,YACA,YACA,eAIAngB,MAAA,0BACAkgB,KAAA,iDACApwB,MAAA,gLACAqwB,QACA,WACA,WACA,YACA,YACA,YACA,YACA,YACA,WACA,cAIAngB,MAAA,OACAkgB,KAAA,mDACApwB,MAAA,kIACAqwB,QACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,WACA,YACA,WACA,cAIAngB,MAAA,mBACAlQ,MAAA,oEACAowB,KAAA,2CACAC,QACA,YACA,YACA,YACA,YACA,aACA,WACA,YACA,YACA,aACA,aACA,YACA,YACA,YACA,WACA,eAIAngB,MAAA,oCACAlQ,MAAA,gJACAowB,KAAA,mIACAC,QACA,WACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,WACA,aACA,aACA,YACA,aACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,YACA,gBAIAngB,MAAA,mBACAkgB,KAAA,6DACApwB,MAAA,kGACAqwB,QACA,YACA,YACA,YACA,YACA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","file":"static/js/app.6acd2692893d6db5bd76.js","sourcesContent":["import Vue from 'vue'\n\nexport default new Vue()\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/pubsub.js","<template lang=\"pug\">\n.wrap\n  .single(v-if=\"!useCollage\")\n    img(:src=\"images[0]\")\n  .collage(v-if=\"useCollage\")\n    .image(v-for=\"image in images\")\n      img(:src=\"image\")\n</template>\n\n<script>\nexport default {\n  name: 'Collage'\n  , props: {\n    images: Array\n  }\n  , data: () => ({\n\n  })\n  , computed: {\n    useCollage(){\n      return this.images.length > 3\n    }\n  }\n  , components: {\n  }\n  , methods: {\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import '@/styles/_variables.scss'\n.wrap\n  line-height: 0\n  width: 100%\n  height: 100%\n  overflow: hidden\n  border-radius: 2px\n\n  .single img\n    width: 100%\n\n.collage\n  height: 200%\n  column-count: 2\n  column-gap: 0\n  column-fill: balance\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/collage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrap\"},[(!_vm.useCollage)?_c('div',{staticClass:\"single\"},[_c('img',{attrs:{\"src\":_vm.images[0]}})]):_vm._e(),(_vm.useCollage)?_c('div',{staticClass:\"collage\"},_vm._l((_vm.images),function(image){return _c('div',{staticClass:\"image\"},[_c('img',{attrs:{\"src\":image}})])}),0):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9a078c34\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/collage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9a078c34\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./collage.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./collage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./collage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9a078c34\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./collage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-9a078c34\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/collage.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.leaf-menu()\n  .flap-title(v-if=\"flapStyle && commonName\")\n    b-tooltip.common-name(:label=\"commonName | titleCase\", type=\"is-dark\", :active=\"commonName.length > (truncateLength + 5)\")\n      .text {{ commonName | titleCase }}\n  .flap-title.flap-title-bottom(v-if=\"flapStyle\")\n    b-tooltip.scientific-name(:label=\"scientificName | titleCase\", type=\"is-dark\", :active=\"scientificName.length > (truncateLength + 5) || shortScientificName.length < scientificName.length\")\n      .text {{ shortScientificName }}\n  .toolbar.primary\n    .button-overlay\n      slot\n    .background-image(:class=\"{ darken: !flapStyle }\")\n      Collage(:images=\"images\")\n    .toolbar-item(v-if=\"!flapStyle\")\n      .toolbar-text.names.item-title\n        b-tooltip.common-name(v-if=\"commonName\", :label=\"commonName | titleCase\", type=\"is-dark\", :active=\"commonName.length > truncateLength\")\n          | {{ commonName | titleCase | truncate(truncateLength) }}\n        b-tooltip.scientific-name(:label=\"scientificName | titleCase\", type=\"is-dark\", :active=\"scientificName.length > truncateLength || shortScientificName.length < scientificName.length\")\n          | {{ shortScientificName | truncate(truncateLength) }}\n</template>\n\n<script>\nimport Collage from '@/components/collage'\n\nexport default {\n  name: 'LeafViewMenu'\n  , props: {\n    commonName: String\n    , flapStyle: Boolean\n    , scientificName: String\n    , shortScientificName: String\n    , images: Array\n    , truncateLength: {\n      type: Number\n      , default: 10\n    }\n  }\n  , data: () => ({\n\n  })\n  , computed: {\n    backgroundStyle(){\n      if ( !this.images || !this.images.length ){ return '' }\n      return `url(${this.images[0]})`\n    }\n  }\n  , components: {\n    Collage\n  }\n  , methods: {\n\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import '@/styles/_variables.scss'\n$menuHeight: 74px\n$menuBackgroundColor: $blue\n$lighterGrey: lighten($grey, 12)\n.leaf-menu\n  position: relative\n  width: 100%\n.flap-title\n  position: absolute\n  top: -1.4em\n  left: 10px\n  right: 10px\n  border-radius: 3px 3px 0 0\n  background: $white\n  // border: 1px solid desaturate(lighten($blue, 20), 50)\n  color: $lighterGrey\n  .scientific-name,\n  .common-name\n    display: block\n    width: 100%\n  .text\n    padding: 0 0.5em\n    white-space: nowrap\n    text-align: center\n    text-overflow: ellipsis\n    overflow: hidden\n.flap-title-bottom\n  top: auto\n  bottom: -1.4em\n  border-radius: 0 0 3px 3px\n.background-image\n  position: absolute\n  top: 0\n  left: 0\n  right: 0\n  bottom: 0\n  z-index: -1\n  background-position: center top\n  background-size: cover\n  background-repeat: no-repeat\n  &.darken\n    filter: saturate(0.8) brightness(0.65)\n.primary, .secondary\n  height: $menuHeight\n  // border: 1px solid $grey-light\n  border-radius: 3px\n  border-color: $blue\n  background: $white\n  transition: transform .3s ease-in-out\n  backface-visibility: hidden;\n  transform-style: preserve-3d;\n  &:hover\n    cursor: pointer\n.primary\n  box-shadow: 0 0 1px rgba(0, 0, 0, 0.2)\n  background: $grey-darker\n  transform: translateZ(-$menuHeight/2) rotateX(0deg) translateZ($menuHeight/2)\n  .active &\n    transform: translateZ(-$menuHeight/2) rotateX(90deg) translateZ($menuHeight/2)\n.secondary\n  background: $grey-darker\n  position: absolute\n  top: 0\n  left: 0\n  transform: translateZ(-$menuHeight/2) rotateX(-90deg) translateZ($menuHeight/2)\n  .active &\n    transform: translateZ(-$menuHeight/2) rotateX(0deg) translateZ($menuHeight/2)\n.button-overlay\n  position: absolute\n  z-index: 2\n  width: 100%\n  height: 100%\n  display: flex\n  align-items: stretch\n  > *\n    flex-grow: 1\n    display: flex\n    align-items: center\n    justify-content: center\n    background: transparentize($blue, 0.4)\n    transition: background 0.3s ease\n    &:hover\n      background: transparentize($blue, 0.1)\n    &:first-child\n      border-radius: 2px 0 0 2px\n      border-right: 1px solid rgba(255, 255, 255, 0.6)\n    &:last-child\n      border-radius: 0 2px 2px 0\n\n  // &:hover\n  //   color: $primary\n// legacy...\n.toolbar .vertical-buttons .toolbar-control\n  padding: 5px 5px\n  transition: background 0.15s ease-in-out\n  background: darken($menuBackgroundColor, 8)\n  box-shadow: inset 1px 0px 0px 0px darken($menuBackgroundColor, 18)\n  border-top: 1px solid darken($menuBackgroundColor, 2)\n  border-bottom: 1px solid darken($menuBackgroundColor, 18)\n\n  &:first-child\n    border-top: none\n    border-radius: 0 2px 0 0\n  &:last-child\n    border-radius: 0 0 2px 0\n\n  &:hover\n    background: darken($menuBackgroundColor, 4)\n  &:active\n    background: darken($menuBackgroundColor, 2)\n  .icon\n    color: darken($menuBackgroundColor, 30)\n    text-shadow: 0.5px 0.5px 1px lighten($menuBackgroundColor, 18)\n\n.secondary .toolbar-control\n  color: $grey-light\n  &:hover\n    color: $white\n.toolbar > .toolbar-item .toolbar-text.names\n  padding: 0 0 0 1em\n  height: 100%\n  display: flex\n  flex-direction: column\n  flex-wrap: nowrap\n  justify-content: center\n  word-break: break-all\n  hyphens: auto\n  .common-name,\n  .scientific-name\n    display: block\n    color: $white-ter\n    text-shadow: 0 0 6px $black-bis\n    &:after\n      text-shadow: none\n  .common-name\n    font-weight: 500\n  .scientific-name\n    font-style: italic\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-leaf-view/leaf-view-menu.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"leaf-menu\"},[(_vm.flapStyle && _vm.commonName)?_c('div',{staticClass:\"flap-title\"},[_c('b-tooltip',{staticClass:\"common-name\",attrs:{\"label\":_vm._f(\"titleCase\")(_vm.commonName),\"type\":\"is-dark\",\"active\":_vm.commonName.length > (_vm.truncateLength + 5)}},[_c('div',{staticClass:\"text\"},[_vm._v(_vm._s(_vm._f(\"titleCase\")(_vm.commonName)))])])],1):_vm._e(),(_vm.flapStyle)?_c('div',{staticClass:\"flap-title flap-title-bottom\"},[_c('b-tooltip',{staticClass:\"scientific-name\",attrs:{\"label\":_vm._f(\"titleCase\")(_vm.scientificName),\"type\":\"is-dark\",\"active\":_vm.scientificName.length > (_vm.truncateLength + 5) || _vm.shortScientificName.length < _vm.scientificName.length}},[_c('div',{staticClass:\"text\"},[_vm._v(_vm._s(_vm.shortScientificName))])])],1):_vm._e(),_c('div',{staticClass:\"toolbar primary\"},[_c('div',{staticClass:\"button-overlay\"},[_vm._t(\"default\")],2),_c('div',{staticClass:\"background-image\",class:{ darken: !_vm.flapStyle }},[_c('Collage',{attrs:{\"images\":_vm.images}})],1),(!_vm.flapStyle)?_c('div',{staticClass:\"toolbar-item\"},[_c('div',{staticClass:\"toolbar-text names item-title\"},[(_vm.commonName)?_c('b-tooltip',{staticClass:\"common-name\",attrs:{\"label\":_vm._f(\"titleCase\")(_vm.commonName),\"type\":\"is-dark\",\"active\":_vm.commonName.length > _vm.truncateLength}},[_vm._v(_vm._s(_vm._f(\"truncate\")(_vm._f(\"titleCase\")(_vm.commonName),_vm.truncateLength)))]):_vm._e(),_c('b-tooltip',{staticClass:\"scientific-name\",attrs:{\"label\":_vm._f(\"titleCase\")(_vm.scientificName),\"type\":\"is-dark\",\"active\":_vm.scientificName.length > _vm.truncateLength || _vm.shortScientificName.length < _vm.scientificName.length}},[_vm._v(_vm._s(_vm._f(\"truncate\")(_vm.shortScientificName,_vm.truncateLength)))])],1)]):_vm._e()])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-608a73d5\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-leaf-view/leaf-view-menu.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-608a73d5\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./leaf-view-menu.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./leaf-view-menu.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./leaf-view-menu.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-608a73d5\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./leaf-view-menu.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-608a73d5\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-leaf-view/leaf-view-menu.vue\n// module id = null\n// module chunks = ","import Promise from 'bluebird'\n\nconst defaultLifetime = 1000 * 60 * 15\n\nfunction getKey( args ){\n  return JSON.stringify( args )\n}\n\nfunction getCached( cache, key ){\n  return cache[ key ]\n}\n\nfunction cacheResult( cache, key, result, lifetime ){\n  cache[ key ] = {\n    expires: Date.now() + lifetime\n    , result\n  }\n\n  return result\n}\n\nfunction isExpired( entry ){\n  return entry.expires < Date.now()\n}\n\nfunction clean( cache ){\n  let keys = Object.keys( cache )\n  for ( let k of keys ){\n    if ( isExpired( cache[k] ) ){\n      delete cache[k]\n    }\n  }\n}\n\nexport default function( fn, lifetime = defaultLifetime ){\n  const cache = {}\n\n  // clean every 10s\n  window.setInterval( () => clean( cache ), 1000 * 10 )\n\n  return function( ...args ){\n    let key = getKey( args )\n    let cachedResult = getCached( cache, key )\n\n    if ( cachedResult && !isExpired( cachedResult ) ){\n      return Promise.resolve( cachedResult.result )\n    }\n\n    return Promise.resolve( fn( ...args ) )\n      .then( result => cacheResult( cache, key, result, lifetime ) )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/cacher.js","// Helpers for OTL api\n// https://github.com/OpenTreeOfLife/germinator/wiki/TNRS-API-v3\n// ---------------------------------------\nimport Promise from 'bluebird'\nimport _castArray from 'lodash/castArray'\nimport _startsWith from 'lodash/startsWith'\nimport _find from 'lodash/find'\nimport _sortBy from 'lodash/sortBy'\nimport _takeWhile from 'lodash/takeWhile'\nimport _every from 'lodash/every'\nimport _reject from 'lodash/reject'\nimport _some from 'lodash/some'\nimport _get from 'lodash/get'\nimport cacher from './cacher'\nimport axios from 'axios'\n\n// flags that correspond to txn info that doesn't have an ott node\nconst BADFLAGS = ['MERGED', 'INCONSISTENT', 'barren']\n\nconst SERVER_TIMEOUT = 10 * 1000\n\nconst otol = axios.create({\n  baseURL: 'https://api.opentreeoflife.org/v3'\n  // baseURL: 'https://ot39.opentreeoflife.org/v3'\n  , timeout: SERVER_TIMEOUT\n  , crossdomain: true\n})\n\nfunction getCommonLineage( nodes ){\n  let lineages = nodes.map( n => [].concat(n.lineage) )\n  lineages.forEach( l => l.reverse() )\n  lineages = _sortBy( lineages, l => l.length )\n  let longest = lineages.pop()\n  let common = _takeWhile( longest, (p, idx) =>\n    _every(lineages, l => l[idx] && l[idx].node_id === p.node_id)\n  )\n  common.pop() // mrca\n  common.reverse()\n  return common\n}\n\n// Get node info\n// id can be either node_id or ott_id. It will auto detect\n// ---------------------------------------\nexport const getNode = cacher(function( id ){\n  if ( _startsWith( id, 'mrca' ) ){\n    return getMRCA( id )\n  }\n  var idField = typeof id === 'string' ? 'node_id' : 'ott_id'\n  var data = {\n    [idField]: id\n    , include_lineage: true\n  }\n  return Promise.resolve( otol.post('/tree_of_life/node_info', data) )\n    .catch(() =>\n      Promise.reject(new Error(`Can not find node \"${id}\" in OTOL database`))\n    )\n    .then( res => res.data )\n    .tap( data => {\n      if ( data.response_for_mrca_of_broken_taxon ){\n        console.error('WARNING: Received response_for_mrca_of_broken_taxon from OTOL')\n      }\n    })\n})\n\n// Get most recent common ancestor of nodes by id or mrca id string\n// ---------------------------------------\nexport function getMRCA( idOrArray ){\n  if ( typeof idOrArray === 'string' ){\n    idOrArray = idOrArray.match(/(ott[\\d]+)/g)\n  }\n\n  var data = {\n    node_ids: idOrArray\n  }\n  return Promise.resolve( otol.post('/tree_of_life/mrca', data) )\n    .then( res => res.data.mrca )\n    .then( data => {\n      return Promise.all([\n        Promise.map( idOrArray, getNode )\n        , data.taxon ? data.taxon : getDescendantNames( data.node_id ).then( childrenNames => ({\n          name: `${childrenNames.join(' and ')}`\n        }))\n      ]).spread( (nodes, taxon) => {\n        let lineage = getCommonLineage( nodes )\n\n        data.taxon = taxon\n\n        data.lineage = lineage\n\n        return data\n      })\n    })\n}\n\nexport function getTxResultsByNames( names = [] ){\n  var data = {\n    names: _castArray( names )\n  }\n\n  return Promise.resolve( otol.post('/tnrs/match_names', data) )\n    .then( res => res.data.results )\n    .then( res => res.map(result => {\n      result.matches = _reject(result.matches, el => _some(_get(el, 'taxon.flags'), f => BADFLAGS.indexOf(f) > -1))\n      return result\n    }))\n    .then( res => _reject(res, r => !r.matches || !r.matches.length ))\n}\n\n// Helper for finding a OTOL node by its tx name\nexport const getNodeByName = cacher(function( name ){\n  return getTxResultsByNames( name )\n    .then( results => _find(results, {'name': name}) )\n    .then( result => {\n      if (!result || !result.matches){\n        throw new Error('Node not found')\n      }\n\n      return result.matches[0].taxon.ott_id\n    })\n    .then( getNode )\n})\n\nexport const getOttIdBySource = cacher(function( source ){\n  let data = {\n    source_id: source\n  }\n\n  return Promise.resolve( otol.post('/taxonomy/taxon_info', data) )\n    .then( res => res.data.ott_id )\n})\n\nexport const getSubtree = cacher(function( id, depth = 1 ){\n  var idField = _startsWith( id, 'ott' ) || _startsWith( id, 'mrca' ) ? 'node_id' : 'ott_id'\n  var data = {\n    [idField]: id\n    , format: 'arguson'\n    , height_limit: depth\n  }\n  return Promise.resolve( otol.post('/tree_of_life/subtree', data) )\n    .then( res => res.data.arguson.children || [] )\n})\n\nexport const getDescendantNames = cacher(function( id ){\n  var idField = _startsWith( id, 'ott' ) || _startsWith( id, 'mrca' ) ? 'node_id' : 'ott_id'\n  var data = {\n    [idField]: id\n    , format: 'arguson'\n    , height_limit: 1\n  }\n  return Promise.resolve( otol.post('/tree_of_life/subtree', data) )\n    .then( res => res.data.arguson.descendant_name_list || [] )\n})\n\nexport function getTxnSourceId( type, node ){\n  if ( !node.taxon ){ return null }\n  let str = _find(node.taxon.tax_sources, (x) => _startsWith(x, type))\n  if ( !str ){\n    return null\n  }\n  return str.replace(`${type}:`, '')\n}\n\nexport function getGbifId( node ){\n  return getTxnSourceId( 'gbif', node )\n}\n\nexport function getWormsId( node ){\n  return getTxnSourceId( 'worms', node )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/otol.js","// Helpers for https://www.gbif.org/developer\n// https://www.gbif.org/developer/registry\n// ---------------------------------------\nimport Promise from 'bluebird'\nimport axios from 'axios'\nimport { setupCache } from 'axios-cache-adapter'\nimport _startCase from 'lodash/startCase'\nimport _uniq from 'lodash/uniq'\n// import _union from 'lodash/union'\nimport _flow from 'lodash/flow'\n\nconst SERVER_TIMEOUT = 10 * 1000\n\nconst parseParams = (params) => {\n  const keys = Object.keys(params)\n  let options = ''\n\n  keys.forEach((key) => {\n    const isParamTypeObject = typeof params[key] === 'object'\n    const isParamTypeArray = isParamTypeObject && (params[key].length >= 0)\n\n    if (!isParamTypeObject) {\n      options += `${key}=${params[key]}&`\n    }\n\n    if (isParamTypeObject && isParamTypeArray) {\n      params[key].forEach((element) => {\n        options += `${key}=${element}&`\n      })\n    }\n  })\n\n  return options ? options.slice(0, -1) : options\n}\n\nconst langs = ['', 'en', 'eng']\n\nconst cache = setupCache({\n  maxAge: 15 * 60 * 1000\n  , key: req => req.url + JSON.stringify(req.params)\n  , exclude: {\n    query: false\n  }\n})\n\nconst gbif = axios.create({\n  baseURL: 'https://api.gbif.org/v1'\n  , timeout: SERVER_TIMEOUT\n  , adapter: cache.adapter\n  , crossdomain: true\n  , paramsSerializer: params => parseParams(params)\n})\n\nfunction setVernacularNames( entry ){\n  if ( !entry.vernacularNames ){\n    entry.vernacularNames = []\n\n    if ( entry.vernacularName ){\n      entry.vernacularNames.push({ vernacularName: entry.vernacularName, language: 'eng' })\n    }\n  }\n\n  var vernacularNameList = entry.vernacularNames.filter(n => !n.language || langs.indexOf(n.language) > -1)\n  vernacularNameList = vernacularNameList.map( _flow([\n    n => n.vernacularName\n    , _startCase\n  ]) )\n  vernacularNameList = _uniq(vernacularNameList).join(', ')\n  return { ...entry, vernacularNameList }\n}\n\nexport function getById( id ){\n  return Promise.resolve( gbif(`/species/${id}`) )\n    .then( res => setVernacularNames( res.data ) )\n}\n\nexport function findByCommonName( q ){\n  var params = {\n    qField: 'VERNACULAR'\n    , status: 'ACCEPTED'\n    , dataset_key: 'fab88965-e69d-4491-a04d-e3198b626e52' // NCBI Database\n    // , rank: ['SUBSPECIES', 'SPECIES']\n    , q\n  }\n  return gbif('/species/search', { params })\n    .then( d => d.data.results )\n    .then( results => results.map( setVernacularNames ) )\n}\n\nexport function findByScientificName( q ){\n  var params = {\n    qField: 'SCIENTIFIC'\n    , status: 'ACCEPTED'\n    , dataset_key: 'fab88965-e69d-4491-a04d-e3198b626e52' // NCBI Database\n    // , rank: 'SUBSPECIES'\n    , q\n  }\n  return gbif('/species/search', { params })\n    .then( d => d.data.results )\n    .then( results => results.map( setVernacularNames ) )\n}\n\nexport function findByName( name ){\n  var params = {\n    name\n  }\n  return Promise.resolve( gbif('/species', { params }) )\n    .then( res => res.data.results.map( setVernacularNames ) )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/gbif.js","import Promise from 'bluebird'\n\nexport default class Throttler {\n  constructor( delay, batchSize = 1 ){\n    this.delay = delay\n    this.batchSize = batchSize\n    this.count = 0\n  }\n\n  schedule( arg ){\n    this.count++\n    let batch = Math.floor(this.count / this.batchSize)\n    let delay = batch * this.delay\n    return Promise.delay( delay ).tap( () => (this.count--) ).return( arg )\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/throttler.js","// Helpers for https://query.wikidata.org\n// ---------------------------------------\nimport Promise from 'bluebird'\nimport axios from 'axios'\nimport { setupCache } from 'axios-cache-adapter'\nimport _pick from 'lodash/pick'\nimport _groupBy from 'lodash/groupBy'\nimport _transform from 'lodash/transform'\nimport _omit from 'lodash/omit'\nimport _values from 'lodash/values'\nimport _mapValues from 'lodash/mapValues'\nimport Throttler from './throttler'\n\nconst SERVER_TIMEOUT = 10 * 1000\n\nconst cache = setupCache({\n  maxAge: 15 * 60 * 1000\n  , exclude: {\n    query: false\n  }\n})\n\nconst wikidata = axios.create({\n  baseURL: 'https://query.wikidata.org'\n  , headers: {\n    'Accept': 'application/sparql-results+json'\n    // , 'Access-Control-Allow-Origin': '*'\n  }\n  , params: {\n    // origin: window.location.origin\n  }\n  , crossdomain: true\n  , timeout: SERVER_TIMEOUT\n  , adapter: cache.adapter\n})\n\nconst throttler = new Throttler( 200, 3 )\n\nwikidata.interceptors.request.use( config => throttler.schedule( config ) )\n\nfunction getItemId( url = '' ){\n  let m = url.match(/\\/([A-z1-9]+$)/)\n  return (m && m[1]) || ''\n}\n\nfunction assembleByItem( results ){\n  const singleProps = ['item', 'itemId', 'itemLabel']\n  // get array of results of objects\n  let items = _groupBy( results, 'itemId' )\n  // want them grouped by itemId\n  return _values(items).map( ( parts ) => {\n    // map the array into an object of array properties\n    // take the first one and use it to set the base object\n    let item = _pick(parts[0], singleProps)\n    return _transform( parts, (result, part) => {\n      Object.keys(_omit(part, singleProps)).forEach( key => {\n        result[key] = result[key] || []\n        if ( result[key].indexOf(part[key]) < 0 ){\n          result[key].push( part[key] )\n        }\n      })\n      return result\n    }, item )\n  } )\n}\n\nwikidata.interceptors.response.use(function (response) {\n  // make it work with cache adaptor\n  if ( response.request.fromCache ){\n    return response\n  }\n  // Do something with response data\n  const { head: { vars }, results } = response.data\n  response.data = results.bindings.map( item =>\n    Object.assign({ itemId: getItemId(item.item.value) }, _mapValues(_pick(item, vars), 'value'))\n  )\n  response.data = assembleByItem(response.data)\n  return response\n}, function (error) {\n  console.dir(error)\n  // just return\n  return Promise.reject(error)\n})\n\nexport function findInfoByNcbiId( ncbiId, { limit, lang } = {} ){\n\n  const sparqlQuery = `SELECT ?item ?itemLabel ?pic ?commonName WHERE {\n    ?item wdt:P685 \"${ncbiId}\".\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '${lang || 'en'}'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  }\n  LIMIT ${limit || 10}`\n\n  return Promise.resolve( wikidata('sparql?query=' + encodeURIComponent( sparqlQuery )) )\n    .then( res => res.data )\n}\n\nexport function findInfoByScientificName( name, { limit, lang } = {} ){\n\n  const sparqlQuery = `SELECT ?item ?itemLabel ?pic ?commonName WHERE {\n    ?item wdt:P225 \"${name}\".\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '${lang || 'en'}'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  }\n  LIMIT ${limit || 10}`\n\n  return Promise.resolve( wikidata('sparql?query=' + encodeURIComponent( sparqlQuery )) )\n    .then( res => res.data )\n}\n\nexport function findInfoByCommonName( q, { limit } = {} ){\n\n  if ( !q ){\n    return Promise.resolve([])\n  }\n\n  const sparqlQuery = `SELECT DISTINCT ?item ?scientificName ?pic ?commonName WHERE {\n    ?item wdt:P1843 ?commonName FILTER regex(?commonName, \"${q}\", \"i\").\n    { ?item wdt:P105 wd:Q7432. }\n    UNION\n    { ?item wdt:P105 wd:Q68947. }\n    ?item wdt:P225 ?scientificName.\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  }\n  LIMIT ${limit || 10}`\n\n  return Promise.resolve( wikidata('sparql?query=' + encodeURIComponent( sparqlQuery )) )\n    .then( res => res.data )\n}\n\nexport function findInfoBy( { ncbiId, name }, { limit, lang } = {} ){\n\n  if ( !ncbiId && !name ){\n    return Promise.resolve([])\n  }\n\n  if ( !name ){\n    return findInfoByNcbiId( ncbiId )\n  }\n\n  if ( !ncbiId ){\n    return findInfoByScientificName( name )\n  }\n\n  const sparqlQuery = `SELECT DISTINCT ?item ?itemLabel ?pic ?commonName WHERE {\n    { ?item wdt:P685 \"${ncbiId}\". }\n    UNION\n    { ?item wdt:P225 \"${name}\". }\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '${lang || 'en'}'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\n  }\n  LIMIT ${limit || 10}`\n\n  return Promise.resolve( wikidata('sparql?query=' + encodeURIComponent( sparqlQuery )) )\n    .then( res => res.data )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/wikidata.js","// Helpers for https://commons.wikimedia.org\n// ---------------------------------------\nimport Promise from 'bluebird'\nimport axios from 'axios'\nimport { setupCache } from 'axios-cache-adapter'\nimport _values from 'lodash/values'\nimport _get from 'lodash/get'\nimport _sortBy from 'lodash/sortBy'\nimport _mapValues from 'lodash/mapValues'\n\nconst SERVER_TIMEOUT = 10 * 1000\n\nconst cache = setupCache({\n  maxAge: 15 * 60 * 1000\n  , key: req => req.url + JSON.stringify(req.params)\n  , exclude: {\n    query: false\n  }\n})\n\nconst wikimedia = axios.create({\n  // baseURL: 'https://commons.wikimedia.org/w'\n  baseURL: 'https://species.wikimedia.org/w'\n  , timeout: SERVER_TIMEOUT\n  , crossdomain: true\n  , adapter: cache.adapter\n})\n\nfunction mapImageResults( results ){\n  return results.map( (page) => {\n    let image = page.imageinfo[0]\n    image = _mapValues( image, val => typeof val === 'string' ? val.replace('http:', 'https:') : val )\n    return {\n      pageid: page.pageid\n      , image\n    }\n  })\n}\n\nexport function findImagesByName( name, { limit, thumbSize } = {} ){\n\n  var params = {\n    'action': 'query'\n    , 'prop': 'imageinfo'\n    , 'generator': 'search'\n    , 'gsrsearch': `File:\"${name}\" NOT map NOT atlas NOT lineage NOT svg NOT phylogram NOT cladogram NOT Destroy_this_mad_brute NOT Classification NOT Anatomical_Man`\n    , 'format': 'json'\n    , 'origin': '*'\n    , 'iiprop': 'url|size'\n  }\n\n  if ( thumbSize ){\n    params.iiurlwidth = thumbSize\n  }\n\n  return Promise.resolve( wikimedia('api.php', { params }) )\n    .then( res => res.data )\n    .then( data => _values( _get(data, 'query.pages') ) )\n    .then( results => results.filter( r => r.title.match(/\\.(gif|png|jpe?g|svg)$/) ) )\n    .then( results => _sortBy(results, 'index') )\n    .then( mapImageResults )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/wikimedia.js","export default [\n  'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Homininae_el.png/200px-Homininae_el.png'\n  , 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/Hominini.ar.png/200px-Hominini.ar.png'\n  , 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/LA2-NSRW-1-0307.jpg/200px-LA2-NSRW-1-0307.jpg'\n]\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/image-blacklist.js","export default {\n  'ott335582': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/1/14/Soimese_Crocicodile.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Soimese_Crocicodile.jpg/200px-Soimese_Crocicodile.jpg'\n  }\n  , 'ott517942': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/6/68/Abete_rosso_1.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/Abete_rosso_1.jpg/180px-Abete_rosso_1.jpg'\n  }\n  , 'ott568878': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/5/53/Pink_striped_mini_phalaenopsis_orchid.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Pink_striped_mini_phalaenopsis_orchid.jpg/320px-Pink_striped_mini_phalaenopsis_orchid.jpg'\n  }\n  , 'ott1007058': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/2/2a/Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg/320px-Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg'\n  }\n  , 'ott352914': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/b/b1/Fungi_city.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Fungi_city.jpg/320px-Fungi_city.jpg'\n  }\n  , 'ott698424': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/5/5c/Killer_whales_%40_Ocean_Show_%288783294977%29.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Killer_whales_%40_Ocean_Show_%288783294977%29.jpg/320px-Killer_whales_%40_Ocean_Show_%288783294977%29.jpg'\n  }\n  , 'ott186816': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/9/94/Snake_King_Cobra.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/Snake_King_Cobra.jpg/320px-Snake_King_Cobra.jpg'\n  }\n  , 'ott417957': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/1/13/Chimpanzee_%2813968481823%29.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Chimpanzee_%2813968481823%29.jpg/284px-Chimpanzee_%2813968481823%29.jpg'\n  }\n  , 'ott541924': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/b/bb/2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG/320px-2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG'\n  }\n  , 'ott770309': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg'\n  }\n  , 'ott770315': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg'\n  }\n  , 'ott563166': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/d/dc/Felis_catus_02.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Felis_catus_02.jpg/200px-Felis_catus_02.jpg'\n  }\n  , 'ott763018': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/2/2d/CloudedLeopard.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/CloudedLeopard.jpg/200px-CloudedLeopard.jpg'\n  }\n  , 'ott532127': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/c/c5/Snow_leoaprd_in_snow.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Snow_leoaprd_in_snow.jpg/200px-Snow_leoaprd_in_snow.jpg'\n  }\n  , 'ott78477': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/selachii.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/selachii.jpg'\n  }\n  , 'ott1005907': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/carassius-auratus.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/carassius-auratus.jpg'\n  }\n  , 'ott244265': {\n    pic: 'https://upload.wikimedia.org/wikipedia/commons/3/3b/Uganda-Kob.jpg'\n    , thumbnail: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Uganda-Kob.jpg/200px-Uganda-Kob.jpg'\n  }\n  , 'ott802117': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/mollusca.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/mollusca.jpg'\n  }\n  , 'ott510761': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg'\n  }\n  , 'ott510762': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg'\n  }\n  , 'ott490099': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/bos-taurus.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/bos-taurus.jpg'\n  }\n  , 'ott312031': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/homininae.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/homininae.jpg'\n  }\n  , 'ott417969': {\n    pic: 'https://cdn.minutelabs.io/tree-of-life-explorer/gorilla.jpg'\n    , thumbnail: 'http://cdn.minutelabs.io/tree-of-life-explorer/gorilla.jpg'\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/image-overrides.js","import Promise from 'bluebird'\nimport _union from 'lodash/union'\nimport _get from 'lodash/get'\nimport _mergeWith from 'lodash/mergeWith'\nimport _isArray from 'lodash/isArray'\nimport _indexOf from 'lodash/indexOf'\nimport _reject from 'lodash/reject'\nimport cacher from '@/lib/cacher'\nimport * as otol from '@/lib/otol'\nimport * as gbif from '@/lib/gbif'\n// import * as worms from '@/lib/worms'\nimport * as wikidata from '@/lib/wikidata'\nimport * as wikimedia from '@/lib/wikimedia'\nimport imageBlacklist from '@/lib/image-blacklist'\nimport imageOverrides from '@/lib/image-overrides'\n\nconst gbifMapping = {\n  'key': false\n  , 'nubKey': false\n  , 'nameKey': false\n  , 'taxonID': false\n  , 'sourceTaxonKey': false\n  , 'kingdom': true\n  , 'phylum': true\n  , 'kingdomKey': false\n  , 'phylumKey': false\n  , 'datasetKey': false\n  , 'constituentKey': false\n  , 'parentKey': false\n  , 'parent': true\n  , 'scientificName': true\n  , 'canonicalName': true\n  , 'vernacularName': true\n  , 'vernacularNames': true\n  , 'vernacularNameList': true\n  , 'authorship': true\n  , 'nameType': false\n  , 'rank': true\n  , 'origin': false\n  , 'taxonomicStatus': 'status'\n  , 'nomenclaturalStatus': false\n  , 'remarks': false\n  , 'numDescendants': true\n  , 'lastCrawled': false\n  , 'lastInterpreted': false\n  , 'issues': false\n  , 'synonym': false\n}\n\n// const wormsMapping = {\n//   'AphiaID': false\n//   , 'url': false\n//   , 'scientificname': 'canonicalName'\n//   , 'authority': false\n//   , 'rank': 'rank'\n//   , 'status': false\n//   , 'unacceptreason': false\n//   , 'valid_AphiaID': false\n//   , 'valid_name': false\n//   , 'valid_authority': false\n//   , 'kingdom': true\n//   , 'phylum': true\n//   , 'class': true\n//   , 'order': true\n//   , 'family': true\n//   , 'genus': true\n//   , 'citation': false\n//   , 'lsid': false\n//   , 'isMarine': false\n//   , 'isBrackish': false\n//   , 'isFreshwater': false\n//   , 'isTerrestrial': false\n//   , 'isExtinct': true\n//   , 'match_type': false\n//   , 'modified': false\n// }\n\n// function mapWikidataImages( data ){\n//   return data.reduce( (output, entry) => {\n//     output.wikidataImages.push(entry.pic)\n//     return output\n//   }, { wikidataImages: [] })\n// }\n\nexport function getMapping( data = {}, mapping ){\n  return Object.keys( mapping ).reduce( (obj, key) => {\n    let m = mapping[ key ]\n    if ( !m ){ return obj }\n    if ( m === true ){\n      m = key\n    }\n\n    obj[ m ] = data[ key ]\n    if ( typeof obj[ m ] === 'string' ){\n      obj[ m ] = obj[ m ].toLowerCase()\n    }\n\n    return obj\n  }, {})\n}\n\nfunction ensureVernacularNames( node, txn ){\n  if ( txn.vernacularNameList && txn.vernacularNameList.length ){\n    return txn\n  }\n\n  if ( !node.taxon ){ return txn }\n\n  return gbif.findByScientificName( node.taxon.unique_name )\n    .then( results => results[0] )\n    .then( data => getMapping( data, gbifMapping ) )\n    .then( data => ({ ...txn, ...data }) )\n}\n\nexport function getTaxonomyInfo( node ){\n\n  var types = {\n    'gbif': ( id ) => gbif.getById( id ).then( data => getMapping( data, gbifMapping ) )\n    // , 'worms': ( id ) => worms.getById( id ).then( data => getMapping( data, wormsMapping ) )\n  }\n\n  var queries = []\n\n  let txnInfoQueries = Promise.map( Object.keys(types), (type) => {\n    let id = otol.getTxnSourceId( type, node )\n    if ( !id ){\n      return null\n    }\n\n    return types[ type ]( id )\n  } )\n\n  queries.push( txnInfoQueries )\n\n  return Promise.all(queries)\n    .then( resultList => _union(...resultList) )\n    .then( results => results.reduce( (txn, data) => ({...txn, ...data}), {} ) )\n    .then( txn => ensureVernacularNames(node, txn) )\n}\n\nfunction toHTTPS( images ){\n  if ( !images || !images.map ){ return images }\n  return images.map( url => url.replace('http:', 'https:') )\n}\n\nfunction applyImageBlacklist( results ){\n  return _reject( results, item => {\n    return _indexOf( imageBlacklist, _get(item, 'image.thumburl') ) > -1\n  })\n}\n\nfunction applyImageOverrides( data, leaf ){\n  let override = imageOverrides[ leaf.node_id ]\n\n  if ( override ){\n    data.pic = _union(toHTTPS([ override.pic ]), data.pic )\n    data.thumbnail = _union(toHTTPS([ override.thumbnail ]), data.thumbnail )\n  }\n\n  return data\n}\n\nexport function getImagesAndCommonNames( name, ncbiId, rank, options = {} ){\n\n  return wikidata.findInfoBy({ ncbiId, name })\n    .then( data => {\n      let firstResult = (data && data[0]) || {}\n\n      if ( options.images === false ){\n        return firstResult\n      }\n\n      let promise\n\n      if ( rank && rank !== 'unranked' && rank !== 'class' ){\n        promise = Promise.join(\n          wikimedia.findImagesByName( `${rank} ${name}`, { thumbSize: options.thumbSize } )\n          , wikimedia.findImagesByName( name, { thumbSize: options.thumbSize } )\n          , ( first, second ) => _union( first, second )\n        )\n      } else {\n        promise = wikimedia.findImagesByName( name, { thumbSize: options.thumbSize } )\n      }\n\n      return promise\n        .then( data => applyImageBlacklist(data) )\n        .then( data => {\n          let images = data.map( item => _get( item, 'image.url' ) )\n          let thumbnails = data.map( item => _get( item, 'image.thumburl' ) )\n\n          firstResult.pic = _union( images, options.getAllImages ? firstResult.pic : [] )\n          firstResult.thumbnail = _union( thumbnails )\n          return firstResult\n        })\n    })\n    .then( data => {\n      data.pic = toHTTPS( data.pic )\n      data.thumbnail = toHTTPS( data.thumbnail )\n      return data\n    })\n}\n\nexport function isMRCA( leaf ){\n  return leaf.node_id.indexOf('mrca') === 0\n}\n\nexport const getTxnInfo = cacher(Promise.coroutine(function* ( leaf, options ){\n  if ( !leaf.taxon ){\n    leaf = yield getLeaf( leaf.node_id )\n  }\n\n  if ( isMRCA(leaf) ){\n    let names = leaf.taxon.name.split(' and ')\n    return Promise.map( names, name =>\n      getImagesAndCommonNames( name, null, leaf.taxon.rank, {getAllImages: false, thumbSize: options.thumbSize, images: options.images} )\n    ).then( results => {\n      return _mergeWith({}, leaf.taxon, ...results, (objValue, srcValue) => {\n        if ( _isArray(objValue) ) {\n          return objValue.concat(srcValue)\n        }\n      })\n    })\n  }\n\n  let ncbiId = otol.getTxnSourceId( 'ncbi', leaf )\n\n  return getTaxonomyInfo( leaf ).then( txnInfo => {\n    return getImagesAndCommonNames(\n      leaf.taxon.unique_name\n      , ncbiId\n      , leaf.taxon.rank\n      , {\n        getAllImages: false\n        , thumbSize: options.thumbSize\n        , images: options.images\n      }\n    ).then( imgNameData => {\n      imgNameData = applyImageOverrides(imgNameData, leaf)\n      return Object.assign({}, leaf.taxon, txnInfo, imgNameData)\n    })\n  })\n}))\n\nfunction Leaf( node ){\n  return {\n    ...node\n  }\n}\n\nexport function getLeaf( id ){\n  return otol.getNode( id ).then( node =>\n    Leaf( node )\n  )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/taxonomy.js","export function copyToClipboard( str ) {\n  const el = document.createElement('textarea')\n  el.value = str\n  el.setAttribute('readonly', '')\n  el.style.position = 'absolute'\n  el.style.left = '-9999px'\n  document.body.appendChild(el)\n  el.select()\n  document.execCommand('copy')\n  document.body.removeChild(el)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","<template lang=\"pug\">\n.card\n  .card-content\n    .content\n      .columns\n        .column.is-half\n          .otl-id\n            span='OTL Id: {{ leaf.node_id }} '\n            a.has-text-small(@click=\"copyToClipboard(leaf.node_id)\") (copy)\n          h1.title.has-text-dark {{ scientificName }}\n          h4.subtitle(v-if=\"commonName\")\n            span.has-text-grey='Commonly known as a '\n            span.has-text-success {{ commonName }}\n\n          .tag-list(v-if=\"!isMRCA\")\n            .tags.has-addons(v-if=\"txnInfo.rank\")\n              span.tag.is-dark\n                | Rank\n              a(:href=\"rankLink\", target=\"_blank\").tag.rank-tag\n                | {{ txnInfo.rank }}\n            .tags.has-addons(v-if=\"txnInfo.numDescendants\")\n              span.tag.is-dark\n                | Decendants\n              span.tag.is-info(:title=\"txnInfo.numDescendants\")\n                | {{ txnInfo.numDescendants | shortNumber }}\n\n          b-message(v-if=\"isMRCA\", type=\"is-info\")\n            | This is an MRCA node\n        .column.is-half(v-if=\"txnInfo.thumbnail && txnInfo.thumbnail.length\")\n          swiper.info-window-swiper(:options=\"swiperOptions\")\n            swiper-slide(v-for=\"img in txnInfo.thumbnail\", :key=\"img\")\n              .image-slide\n                img(:src=\"img\")\n            .swiper-button-prev(v-if=\"!isTouch\", slot=\"button-prev\")\n              b-icon(icon=\"chevron-left\")\n            .swiper-button-next(v-if=\"!isTouch\", slot=\"button-next\")\n              b-icon(icon=\"chevron-right\")\n            .swiper-pagination(slot=\"pagination\")\n    .links\n      .is-size-5.heading Find more information on...\n      .columns.is-mobile.is-multiline\n        .column.is-one-quarter-tablet.is-half-mobile(v-for=\"link in links\")\n          a(:href=\"link.url\", target=\"_blank\")\n            .card.clickable\n              .card-image\n                figure.image\n                  img(:src=\"link.image\")\n              .card-content\n                .content.has-text-centered {{ link.text }}\n</template>\n\n<script>\nimport _remove from 'lodash/remove'\nimport { isMRCA } from '@/lib/taxonomy'\nimport { getTxnSourceId } from '@/lib/otol'\nimport { copyToClipboard } from '@/lib/utils'\n\nexport default {\n  name: 'TaxonomyInfoWindow'\n  , props: {\n    leaf: Object\n    , txnInfo: Object\n  }\n  , data: () => ({\n    currentPic: 0\n    , swiperOptions: {\n      navigation: {\n        nextEl: '.swiper-button-next'\n        , prevEl: '.swiper-button-prev'\n      }\n      , pagination: {\n        el: '.swiper-pagination'\n      }\n    }\n    , isTouch: ('ontouchstart' in document.documentElement)\n  })\n  , computed: {\n    commonName(){\n      if ( this.isMRCA ){ return '' }\n      if ( !this.txnInfo || !this.txnInfo.vernacularNameList ){\n        if ( this.otherCommonNames ){\n          return this.otherCommonNames[0]\n        }\n        return ''\n      }\n      return this.txnInfo.vernacularNameList\n    }\n    , scientificName(){\n      if ( !this.txnInfo ){ return '' }\n      return this.txnInfo.canonicalName ||\n        this.txnInfo.name ||\n        this.leaf.node_id || ''\n    }\n    , isMRCA(){\n      return this.leaf && isMRCA(this.leaf)\n    }\n    , rankLink(){\n      return `https://en.wikipedia.org/wiki/${this.txnInfo.rank}_(biology)`\n    }\n    , links(){\n      let ncbiId = getTxnSourceId( 'ncbi', this.leaf )\n      let gbifId = getTxnSourceId( 'gbif', this.leaf )\n      return _remove([\n        {\n          text: `Wikipedia`\n          , url: this.isMRCA ? false : `https://en.wikipedia.org/wiki/${this.scientificName}`\n          , image: 'https://3c1703fe8d.site.internapcdn.net/newman/gfx/news/hires/2017/58af0228b8aa8.jpg'\n        }\n        , {\n          text: `Open Tree of Life`\n          , url: `https://tree.opentreeoflife.org/opentree/argus/opentree@${this.leaf.node_id}`\n          , image: 'https://avatars2.githubusercontent.com/u/1752618?s=400&v=4'\n        }\n        , {\n          text: 'NCBI'\n          , url: ncbiId ? `https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id=${ncbiId}` : false\n          , image: 'https://pbs.twimg.com/profile_images/759051827/26243_367877492480_367794192480_4194340_6124010_n_400x400.jpg'\n        }\n        , {\n          text: 'GBIF'\n          , url: gbifId ? `https://www.gbif.org/species/${gbifId}` : false\n          , image: 'https://pbs.twimg.com/profile_images/638655521218785280/XCFoWw5r.jpg'\n        }\n      ], obj => obj.url)\n    }\n  }\n  , components: {\n  }\n  , methods: {\n    nextImage(){\n      let len = this.txnInfo.thumbnail.length\n      this.currentPic = (this.currentPic + 1) % len\n    }\n    , prevImage(){\n      let len = this.txnInfo.thumbnail.length\n      this.currentPic = (this.currentPic - 1 + len) % len\n    }\n    , copyToClipboard( str ){\n      this.$toast.open({\n        message: 'copied ID to clipboard'\n        , type: 'is-info'\n        , position: 'is-top-left'\n      })\n\n      copyToClipboard( str )\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import '@/styles/_variables.scss'\n.swiper-container\n  border-radius: 3px\n  background: $black\n  .swiper-button-next,\n  .swiper-button-prev\n    height: 38px\n    top: auto\n    bottom: 0\n    width: 38px\n    margin-top: 0\n    transition: background-color 0.3s ease\n    background: transparentize($black, 0.4)\n    border-radius: 3px\n    color: white\n    text-align: center\n    line-height: 45px\n    &:hover\n      background: transparentize($blue, 0.4)\n.swiper-button-prev\n  left: 0\n.swiper-button-next\n  right: 0\n.image-slide\n  text-align: center\n  max-height: 400px\n  img\n    width: 100%\n    max-width: none\n.media-right\n  position: relative\n  width: 256px\n  .controls\n    position: absolute\n    top: 10px\n    right: 10px\n    z-index: 1\n.tag-list\n  display: flex\n  flex-wrap: wrap\n  .tags\n    flex-wrap: nowrap\n    margin: 0 1em 0 0\n  .rank-tag\n    background: $purple\n    color: lighten($purple, 80)\n.otl-id\n  font-weight: normal\n  font-size: 0.8rem\n  line-height: 1.5\n  font-family: $family-monospace\n.links\n  .card\n    height: 100%\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/taxonomy-info-window.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-content\"},[_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column is-half\"},[_c('div',{staticClass:\"otl-id\"},[_c('span',[_vm._v(\"OTL Id: \"+_vm._s(_vm.leaf.node_id)+\" \")]),_c('a',{staticClass:\"has-text-small\",on:{\"click\":function($event){return _vm.copyToClipboard(_vm.leaf.node_id)}}},[_vm._v(\"(copy)\")])]),_c('h1',{staticClass:\"title has-text-dark\"},[_vm._v(_vm._s(_vm.scientificName))]),(_vm.commonName)?_c('h4',{staticClass:\"subtitle\"},[_c('span',{staticClass:\"has-text-grey\"},[_vm._v(\"Commonly known as a \")]),_c('span',{staticClass:\"has-text-success\"},[_vm._v(_vm._s(_vm.commonName))])]):_vm._e(),(!_vm.isMRCA)?_c('div',{staticClass:\"tag-list\"},[(_vm.txnInfo.rank)?_c('div',{staticClass:\"tags has-addons\"},[_c('span',{staticClass:\"tag is-dark\"},[_vm._v(\"Rank\")]),_c('a',{staticClass:\"tag rank-tag\",attrs:{\"href\":_vm.rankLink,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.txnInfo.rank))])]):_vm._e(),(_vm.txnInfo.numDescendants)?_c('div',{staticClass:\"tags has-addons\"},[_c('span',{staticClass:\"tag is-dark\"},[_vm._v(\"Decendants\")]),_c('span',{staticClass:\"tag is-info\",attrs:{\"title\":_vm.txnInfo.numDescendants}},[_vm._v(_vm._s(_vm._f(\"shortNumber\")(_vm.txnInfo.numDescendants)))])]):_vm._e()]):_vm._e(),(_vm.isMRCA)?_c('b-message',{attrs:{\"type\":\"is-info\"}},[_vm._v(\"This is an MRCA node\")]):_vm._e()],1),(_vm.txnInfo.thumbnail && _vm.txnInfo.thumbnail.length)?_c('div',{staticClass:\"column is-half\"},[_c('swiper',{staticClass:\"info-window-swiper\",attrs:{\"options\":_vm.swiperOptions}},[_vm._l((_vm.txnInfo.thumbnail),function(img){return _c('swiper-slide',{key:img},[_c('div',{staticClass:\"image-slide\"},[_c('img',{attrs:{\"src\":img}})])])}),(!_vm.isTouch)?_c('div',{staticClass:\"swiper-button-prev\",attrs:{\"slot\":\"button-prev\"},slot:\"button-prev\"},[_c('b-icon',{attrs:{\"icon\":\"chevron-left\"}})],1):_vm._e(),(!_vm.isTouch)?_c('div',{staticClass:\"swiper-button-next\",attrs:{\"slot\":\"button-next\"},slot:\"button-next\"},[_c('b-icon',{attrs:{\"icon\":\"chevron-right\"}})],1):_vm._e(),_c('div',{staticClass:\"swiper-pagination\",attrs:{\"slot\":\"pagination\"},slot:\"pagination\"})],2)],1):_vm._e()])]),_c('div',{staticClass:\"links\"},[_c('div',{staticClass:\"is-size-5 heading\"},[_vm._v(\"Find more information on...\")]),_c('div',{staticClass:\"columns is-mobile is-multiline\"},_vm._l((_vm.links),function(link){return _c('div',{staticClass:\"column is-one-quarter-tablet is-half-mobile\"},[_c('a',{attrs:{\"href\":link.url,\"target\":\"_blank\"}},[_c('div',{staticClass:\"card clickable\"},[_c('div',{staticClass:\"card-image\"},[_c('figure',{staticClass:\"image\"},[_c('img',{attrs:{\"src\":link.image}})])]),_c('div',{staticClass:\"card-content\"},[_c('div',{staticClass:\"content has-text-centered\"},[_vm._v(_vm._s(link.text))])])])])])}),0)])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-696249e7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/taxonomy-info-window.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-696249e7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./taxonomy-info-window.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./taxonomy-info-window.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./taxonomy-info-window.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-696249e7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./taxonomy-info-window.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-696249e7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/taxonomy-info-window.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.item(\n  @mousedown.stop=\"\"\n  , :data-ott=\"leaf.node_id\"\n  , :class=\"{ hovering: hovering, 'flap-style': flapStyle, horizontal: horizontal, vertical: !horizontal }\"\n)\n  .card.is-shadowless(\n    v-if=\"isAddedToTree\"\n    , @mouseleave.stop.prevent=\"onMouseLeave\"\n    , @mouseenter.stop.prevent=\"onMouseEnter\"\n    , @touchstart.capture=\"onTouch\"\n  )\n    .card-header.is-shadowless\n      b-tooltip.overlay-btn.cut-btn(label=\"Remove this whole branch\", type=\"is-dark\")\n        .btn(@click=\"$emit('cut', leaf)\")\n          b-icon(icon=\"scissors-cutting\", size=\"is-medium\")\n          b-icon.trash(icon=\"close\", size=\"is-small\")\n      b-tooltip.overlay-btn.descendants-btn(label=\"See descendants\", type=\"is-dark\", slot=\"front-button\")\n        b-dropdown.limit-dropdown(@active-change=\"getSubtree()\", @wheel.native.stop=\"\", :mobile-modal=\"false\")\n          b-icon(icon=\"file-tree\", size=\"is-medium\", slot=\"trigger\")\n          b-loading(:is-full-page=\"false\", :active=\"loading\")\n          b-dropdown-item.heading.has-text-info Descendants\n          b-dropdown-item(v-if=\"children && children.length\")\n            b-field\n              .control\n                .button.is-small(@click=\"$emit('add-node', children.map(n => n.node_id))\")\n                  b-icon(icon=\"expand-all\", size=\"is-small\")\n                  span Expand All\n              .control\n                .button.is-small(@click=\"$emit('remove-node', children.map(n => n.node_id))\")\n                  b-icon(icon=\"collapse-all\", size=\"is-small\")\n                  span Remove All\n          hr.dropdown-divider\n          b-dropdown-item(\n            v-if=\"children && children.length\",\n            v-for=\"child in children\",\n            :class=\"{ 'has-text-grey-light': childIsAdded(child) }\",\n            :key=\"child.node_id\",\n            @click=\"$emit('add-node', child.node_id)\"\n            )\n            | {{ child | nodeName }}\n          b-dropdown-item(v-if=\"!loading && children && !children.length\")\n            | None\n      LeafViewMenu(:common-name=\"commonName\",\n        :scientific-name=\"scientificName\",\n        :flap-style=\"flapStyle\",\n        :short-scientific-name=\"shortScientificName\",\n        :truncate-length=\"commonName ? truncateLength : truncateLength * 2\",\n        :images=\"hideImages ? [] : txnImages\"\n        )\n        b-tooltip.overlay-btn.info-btn(label=\"More Information\", type=\"is-dark\")\n          a.toolbar-control(@click=\"hovering && openInfoWindow()\", @touchstart=\"hovering && openInfoWindow()\")\n            b-icon(icon=\"feature-search\", size=\"is-large\")\n        b-tooltip.overlay-btn.remove-btn(label=\"Remove just this node\", type=\"is-dark\")\n          a.toolbar-control(@click=\"hovering && $emit('remove', leaf.node_id)\", @touchstart=\"hovering && $emit('remove', leaf.node_id)\")\n            b-icon(icon=\"close-network\", size=\"is-large\")\n  .minimal(v-if=\"!isAddedToTree\", @click=\"$emit('add-node', leaf.node_id)\")\n    .card-title {{ commonName || shortScientificName }}\n    //- .pin-btn\n    //-   b-icon(icon=\"file-plus\", size=\"is-small\")\n</template>\n\n<script>\nimport _capitalize from 'lodash/capitalize'\nimport LeafViewMenu from './leaf-view-menu'\nimport { getTxnInfo, isMRCA } from '@/lib/taxonomy'\nimport { getSubtree } from '@/lib/otol'\nimport TaxonomyInfoWindow from '@/components/taxonomy-info-window'\n\nfunction titleCase( str = '' ){\n  return str.split(' ').map( w => _capitalize(w) ).join(' ')\n}\n\nfunction shortName( str, target ){\n  let words = str.split(' ')\n  let out = str\n  let i = 0\n  while ( out.length > target && i < words.length - 1 ){\n    let word = words[ i ]\n    words[ i ] = `${word[ 0 ]}.`\n    out = words.join(' ')\n    i++\n  }\n  return out\n}\n\n// function isLowerRank( rank = '' ){\n//   return [\n//     'variety'\n//     , 'species'\n//     , 'subspecies'\n//     , 'genus'\n//     , 'subgenus'\n//     , 'family'\n//     , 'subfamily'\n//     , 'class'\n//     , 'subclass'\n//     , 'order'\n//     , 'superorder'\n//   ].indexOf(rank) > -1\n// }\n\nconst interactionHideDelay = 200\n\nexport default {\n  name: 'TOLLeafView'\n  , props: ['leaf', 'truncateLength', 'hideImages', 'flapStyle', 'horizontal']\n  , components: {\n    LeafViewMenu\n  }\n  , filters: {\n    shortName\n  }\n  , data: () => ({\n    txnImages: []\n    , otherCommonNames: []\n    , pin: false\n    , expanded: false\n    , txnInfo: null\n    , children: null\n    , loading: true\n    , hovering: false\n  })\n  , watch: {\n    leaf: {\n      handler( leaf ){\n        if ( !leaf ){ return }\n\n        getTxnInfo( leaf, { thumbSize: 200 } ).then( info => {\n          this.txnInfo = info\n          this.otherCommonNames = info.commonName\n\n          // no images for higher ranks\n          // if ( !isLowerRank(this.txnInfo.rank) ){\n          //   return\n          // }\n\n          if ( info.thumbnail ){\n            let nImages = ['variety', 'species', 'subspecies'].indexOf(this.txnInfo.rank) === -1 ? 2 : 1\n            this.txnImages = info.thumbnail.slice(0, nImages)\n          } else if ( info.pic ){\n            let nImages = ['variety', 'species', 'subspecies'].indexOf(this.txnInfo.rank) === -1 ? 2 : 1\n            this.txnImages = info.pic.slice(0, nImages)\n          }\n        }).catch( ( err ) => this.$emit('error', err) )\n      }\n      , immediate: true\n    }\n  }\n  , computed: {\n    commonName(){\n      if ( this.isMRCA ){ return '' }\n      if ( !this.txnInfo || !this.txnInfo.vernacularNameList ){\n        if ( this.otherCommonNames ){\n          return titleCase(this.otherCommonNames[0])\n        }\n        return ''\n      }\n      return titleCase(this.txnInfo.vernacularNameList)\n    }\n    , shortScientificName(){\n      return shortName(this.scientificName, this.isMRCA ? 1000 : this.truncateLength)\n    }\n    , scientificName(){\n      if ( !this.txnInfo ){ return '' }\n      return this.txnInfo.canonicalName ||\n        this.txnInfo.name ||\n        this.leaf.node_id || ''\n    }\n    , isMRCA(){\n      return this.leaf && isMRCA(this.leaf)\n    }\n    , isAddedToTree(){\n      return this.childIsAdded( this.leaf )\n    }\n  }\n  , methods: {\n    childIsAdded( child ){\n      if ( !this.$route.query.ids ){ return false }\n      return this.$route.query.ids.indexOf( child.node_id ) > -1\n    }\n    , getSubtree(){\n      if ( this.children ){ return }\n      this.children = []\n      this.loading = true\n\n      if ( !this.leaf ){\n        this.active = false\n        return\n      }\n\n      this.active = true\n\n      getSubtree( this.leaf.node_id ).then( children => {\n        this.children = this.children.concat(children)\n        this.loading = false\n      }).catch( e => console.error(e) )\n    }\n    , openInfoWindow(){\n      this.$modal.open({\n        parent: this\n        , component: TaxonomyInfoWindow\n        , props: {\n          leaf: this.leaf\n          , txnInfo: this.txnInfo\n        }\n        , hasModalCard: false\n      })\n    }\n    , show(){\n      this.hovering = true\n    }\n    , hide(){\n      this.hovering = false\n    }\n    , startTimer( delay ){\n      this.timer = setTimeout(() => this.hide(), delay || interactionHideDelay)\n    }\n    , clearTimer(){\n      clearTimeout( this.timer )\n    }\n    , onTouch( e ){\n      if ( !this.hovering ){\n        e.preventDefault()\n        e.stopImmediatePropagation()\n      }\n\n      this.clearTimer()\n      this.show()\n      this.startTimer( 3000 )\n    }\n    , onMouseLeave( e ){\n      this.startTimer()\n    }\n    , onMouseEnter( e ){\n      setTimeout(() => this.show(), 50)\n      this.clearTimer()\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"sass\">\n@import '@/styles/_variables.scss'\n$greyBlue: desaturate(lighten($blue, 20), 50)\n\n.overlay-btn\n  transition: opacity 0.15s ease\n  opacity: 0\n  .hovering &,\n  .tour-hover &\n    opacity: 1\n.cut-btn,\n.descendants-btn\n  position: absolute\n  color: $yellow\n  cursor: pointer\n  &:active\n    color: $blue\n.cut-btn\n  .icon\n    overflow: hidden\n    height: 26px\n    padding-top: 6px\n  .horizontal &\n    left: -36px\n    top: 9px\n  .vertical &\n    left: calc(50% - 2px)\n    top: -32px\n    .icon\n      transform: rotate(90deg)\n  .vertical.flap-style &\n    top: -54px\n  .icon.trash\n    display: block\n    position: relative\n    bottom: 25px\n    left: 20px\n    overflow: visible\n    color: lighten($red, 15)\n    .vertical &\n      bottom: 23px\n      left: -1px\n.descendants-btn\n  background: $white\n  .horizontal &\n    right: -35px\n    top: 18px\n  .vertical &\n    left: calc(50% - 1rem)\n    bottom: -2.4em\n    padding-top: 4px\n  .vertical.flap-style &\n    bottom: -56px\n.toolbar-control\n  color: $grey-lighter\n.icon-button\n  color: $white\n  &:hover,\n  .dropdown.is-active &\n    color: lighten($blue, 10)\n.item .remove-btn\n  background: transparentize($red, 0.4)\n  &:hover\n    background: transparentize($red, 0.1)\n\n.minimal\n  position: relative\n  bottom: 1px\n  text-align: center\n  // border: 1px solid $greyBlue\n  // border-radius: 3px\n  // background: $greyBlue\n  cursor: pointer\n\n  .vertical &\n    bottom: -25px\n\n  .card-title\n    display: inline-block\n    background: $white\n    color: lighten($grey, 12)\n    padding: 0 1rem\n    transition: color 0.15s ease\n\n  &:hover .card-title\n    color: $blue\n\n  // .common-name\n  //   padding-right: 24px\n  .pin-btn\n    position: absolute\n    top: 0\n    right: 0\n    width: 24px\n    height: 24px\n    text-align: center\n    background: $greyBlue\n    color: $white\n    border: 1px solid $white\n    border-radius: 50%\n    line-height: 24px\n    padding-left: 1px\n    cursor: pointer\n  &:hover .pin-btn\n    border-color: $greyBlue\n    background-color: $white\n    color: $grey-darker\n  &:active .pin-btn\n    top: 1px\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-leaf-view/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"item\",class:{ hovering: _vm.hovering, 'flap-style': _vm.flapStyle, horizontal: _vm.horizontal, vertical: !_vm.horizontal },attrs:{\"data-ott\":_vm.leaf.node_id},on:{\"mousedown\":function($event){$event.stopPropagation();}}},[(_vm.isAddedToTree)?_c('div',{staticClass:\"card is-shadowless\",on:{\"mouseleave\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onMouseLeave($event)},\"mouseenter\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onMouseEnter($event)},\"!touchstart\":function($event){return _vm.onTouch($event)}}},[_c('div',{staticClass:\"card-header is-shadowless\"},[_c('b-tooltip',{staticClass:\"overlay-btn cut-btn\",attrs:{\"label\":\"Remove this whole branch\",\"type\":\"is-dark\"}},[_c('div',{staticClass:\"btn\",on:{\"click\":function($event){return _vm.$emit('cut', _vm.leaf)}}},[_c('b-icon',{attrs:{\"icon\":\"scissors-cutting\",\"size\":\"is-medium\"}}),_c('b-icon',{staticClass:\"trash\",attrs:{\"icon\":\"close\",\"size\":\"is-small\"}})],1)]),_c('b-tooltip',{staticClass:\"overlay-btn descendants-btn\",attrs:{\"slot\":\"front-button\",\"label\":\"See descendants\",\"type\":\"is-dark\"},slot:\"front-button\"},[_c('b-dropdown',{staticClass:\"limit-dropdown\",attrs:{\"mobile-modal\":false},on:{\"active-change\":function($event){return _vm.getSubtree()}},nativeOn:{\"wheel\":function($event){$event.stopPropagation();}}},[_c('b-icon',{attrs:{\"slot\":\"trigger\",\"icon\":\"file-tree\",\"size\":\"is-medium\"},slot:\"trigger\"}),_c('b-loading',{attrs:{\"is-full-page\":false,\"active\":_vm.loading}}),_c('b-dropdown-item',{staticClass:\"heading has-text-info\"},[_vm._v(\"Descendants\")]),(_vm.children && _vm.children.length)?_c('b-dropdown-item',[_c('b-field',[_c('div',{staticClass:\"control\"},[_c('div',{staticClass:\"button is-small\",on:{\"click\":function($event){_vm.$emit('add-node', _vm.children.map(function (n) { return n.node_id; }))}}},[_c('b-icon',{attrs:{\"icon\":\"expand-all\",\"size\":\"is-small\"}}),_c('span',[_vm._v(\"Expand All\")])],1)]),_c('div',{staticClass:\"control\"},[_c('div',{staticClass:\"button is-small\",on:{\"click\":function($event){_vm.$emit('remove-node', _vm.children.map(function (n) { return n.node_id; }))}}},[_c('b-icon',{attrs:{\"icon\":\"collapse-all\",\"size\":\"is-small\"}}),_c('span',[_vm._v(\"Remove All\")])],1)])])],1):_vm._e(),_c('hr',{staticClass:\"dropdown-divider\"}),_vm._l((_vm.children),function(child){return (_vm.children && _vm.children.length)?_c('b-dropdown-item',{key:child.node_id,class:{ 'has-text-grey-light': _vm.childIsAdded(child) },on:{\"click\":function($event){return _vm.$emit('add-node', child.node_id)}}},[_vm._v(_vm._s(_vm._f(\"nodeName\")(child)))]):_vm._e()}),(!_vm.loading && _vm.children && !_vm.children.length)?_c('b-dropdown-item',[_vm._v(\"None\")]):_vm._e()],2)],1),_c('LeafViewMenu',{attrs:{\"common-name\":_vm.commonName,\"scientific-name\":_vm.scientificName,\"flap-style\":_vm.flapStyle,\"short-scientific-name\":_vm.shortScientificName,\"truncate-length\":_vm.commonName ? _vm.truncateLength : _vm.truncateLength * 2,\"images\":_vm.hideImages ? [] : _vm.txnImages}},[_c('b-tooltip',{staticClass:\"overlay-btn info-btn\",attrs:{\"label\":\"More Information\",\"type\":\"is-dark\"}},[_c('a',{staticClass:\"toolbar-control\",on:{\"click\":function($event){_vm.hovering && _vm.openInfoWindow()},\"touchstart\":function($event){_vm.hovering && _vm.openInfoWindow()}}},[_c('b-icon',{attrs:{\"icon\":\"feature-search\",\"size\":\"is-large\"}})],1)]),_c('b-tooltip',{staticClass:\"overlay-btn remove-btn\",attrs:{\"label\":\"Remove just this node\",\"type\":\"is-dark\"}},[_c('a',{staticClass:\"toolbar-control\",on:{\"click\":function($event){_vm.hovering && _vm.$emit('remove', _vm.leaf.node_id)},\"touchstart\":function($event){_vm.hovering && _vm.$emit('remove', _vm.leaf.node_id)}}},[_c('b-icon',{attrs:{\"icon\":\"close-network\",\"size\":\"is-large\"}})],1)])],1)],1)]):_vm._e(),(!_vm.isAddedToTree)?_c('div',{staticClass:\"minimal\",on:{\"click\":function($event){return _vm.$emit('add-node', _vm.leaf.node_id)}}},[_c('div',{staticClass:\"card-title\"},[_vm._v(_vm._s(_vm.commonName || _vm.shortScientificName))])]):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2577aafe\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-leaf-view/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2577aafe\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2577aafe\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2577aafe\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-leaf-view/index.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.mrca-item\n  .item-title\n    span(v-if=\"loading\") ...\n    .names(v-if=\"!loading\")\n      .common-name {{ commonName | capitalize | truncate(24) }}\n      .scientific-name {{ scientificName | capitalize | truncate(24) }}\n</template>\n\n<script>\nimport { getTxnInfo } from '@/lib/taxonomy'\n\nexport default {\n  name: 'TOLMRCAView'\n  , props: ['leaf']\n  , components: {\n\n  }\n  , data: () => ({\n    leafData: null\n    , txnInfo: null\n    , loading: true\n  })\n  , watch: {\n    leaf: {\n      handler( leaf ){\n        if ( !leaf ){ return }\n\n        getTxnInfo( leaf ).then( leaf => {\n          this.txnInfo = leaf.txnInfo\n        }).catch( ( err ) =>\n          this.$emit('error', err)\n        ).finally( () => (this.loading = false) )\n      }\n      , immediate: true\n    }\n  }\n  , computed: {\n    commonName(){\n      if ( !this.txnInfo ){ return '' }\n      return this.txnInfo.vernacularNameList\n    }\n    , scientificName(){\n      if ( !this.txnInfo ){ return '' }\n      return this.txnInfo.canonicalName ||\n        this.leaf.taxon ? this.leaf.taxon.name : this.leaf.node_id\n    }\n  }\n  , methods: {\n  }\n}\n</script>\n\n<style scoped lang=\"sass\">\n@import '@/styles/_variables.scss'\n.item-title\n  text-align: center\n  background: $white\n.icon-button\n  color: $white\n  &:hover,\n  .dropdown.is-active &\n    color: lighten($blue, 10)\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-mrca-view/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mrca-item\"},[_c('div',{staticClass:\"item-title\"},[(_vm.loading)?_c('span',[_vm._v(\"...\")]):_vm._e(),(!_vm.loading)?_c('div',{staticClass:\"names\"},[_c('div',{staticClass:\"common-name\"},[_vm._v(_vm._s(_vm._f(\"truncate\")(_vm._f(\"capitalize\")(_vm.commonName),24)))]),_c('div',{staticClass:\"scientific-name\"},[_vm._v(_vm._s(_vm._f(\"truncate\")(_vm._f(\"capitalize\")(_vm.scientificName),24)))])]):_vm._e()])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4ac34044\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-mrca-view/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4ac34044\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4ac34044\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4ac34044\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-mrca-view/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a52bee48\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./node.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./node.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./node.vue\"\n/* template */\nvar __vue_template__ = null\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/node.vue\n// module id = null\n// module chunks = ","<script>\n// import VueMixinTween from 'vue-mixin-tween'\n// import TWEEN from '@tweenjs/tween.js'\nexport default {\n  name: 'Node'\n  // , functional: true\n  , inject: [ 'svg' ]\n  , props: [ 'tree', 'x', 'y' ]\n  , data: () => ({\n\n  })\n  , mixins: [\n    // VueMixinTween('x', 700, TWEEN.Easing.Quadratic.InOut)\n    // , VueMixinTween('y', 700, TWEEN.Easing.Quadratic.InOut)\n  ]\n  , beforeDestroy(){\n    this.node.off( 'click' )\n    this.node.remove()\n  }\n  , beforeMount(){\n    let nodeWidth = 36\n    let scene = this.svg\n    this.node = scene.group().addClass('svg-node').move( 0, 0 )\n\n    this.node.rect(nodeWidth, nodeWidth).center(6, -6).radius(7)\n    this.node.rect(nodeWidth, nodeWidth).center(3, -3).radius(7)\n    this.node.rect(nodeWidth, nodeWidth).center(0, 0).radius(7)\n\n    this.label = this.node.plain( `${this.tree.lineage.length}` ).attr('y', 2)\n\n    this.node.on( 'click', (e) => {\n      e.stopPropagation()\n      this.$emit( 'click', { subtree: this.tree, x: this.x, y: this.y } )\n    })\n  }\n  , render( h ){\n    // this.node.move( this.xTween, this.yTween ).front()\n    this.node.data( 'ott', this.tree.leaf.node_id )\n    this.node.style( 'transform', `translate3d(${this.x}px, ${this.y}px, 0)`).front()\n    this.label.plain( `${this.tree.lineage.length}` )\n    return this.node\n  }\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/styles/_variables.scss'\n.svg-node\n  cursor: pointer\n  transition: transform 0.7s ease-in-out\n  rect\n    fill: desaturate(lighten($blue, 20), 50)\n    stroke: white\n    transition: all 0.15s linear\n\n  // circle\n  //   fill: $white\n  //   stroke-width: 2\n  //   stroke: $grey-light\n  //   transition: all 0.15s linear\n\n  text\n    font-size: 20px\n    text-anchor: middle\n    dominant-baseline: middle\n    fill: $white\n    transition: fill 0.15s linear\n\n  &:hover rect\n    fill: $blue\n\n  &:hover text\n    fill: $white\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/node.vue","<script>\nconst width = 40\nconst thickness = 40\nexport default {\n  name: 'AncestorCollapse'\n  , inject: [ 'svg' ]\n  , props: [ 'tree', 'x', 'y', 'horizontal' ]\n  , data: () => ({\n\n  })\n  , watch: {\n    horizontal: 'drawDots'\n  }\n  , beforeDestroy(){\n    this.node.off( 'click' )\n    this.node.remove()\n  }\n  , beforeMount(){\n    let scene = this.svg\n    this.node = scene.group().addClass('svg-ancestor-collapse').move( 0, 0 )\n\n    this.node.rect(width, thickness).center(0, 0).radius( 7 )\n\n    this.dots = this.node.group()\n    this.drawDots()\n\n    this.label = this.node.plain( `${this.tree.lineage.length}` )\n\n    this.node.on( 'click', (e) => {\n      e.stopPropagation()\n      this.$emit( 'click', { subtree: this.tree, x: this.x, y: this.y } )\n    })\n  }\n  , methods: {\n    drawDots(){\n      this.dots.clear()\n      if ( this.horizontal ){\n        this.dots.circle(3).center(width / 5, 0)\n        this.dots.circle(3).center(0, 0)\n        this.dots.circle(3).center(-width / 5, 0)\n      } else {\n        this.dots.circle(3).center(0, width / 5)\n        this.dots.circle(3).center(0, 0)\n        this.dots.circle(3).center(0, -width / 5)\n      }\n    }\n  }\n  , render( h ){\n    this.node.data( 'ott', this.tree.leaf.node_id )\n\n    if ( this.horizontal ){\n      this.node.addClass('horizontal')\n    } else {\n      this.node.removeClass('horizontal')\n    }\n\n    this.node.style( 'transform', `translate3d(${this.x}px, ${this.y}px, 0)`).front()\n\n    if ( this.horizontal ){\n      this.label.attr('x', 0).attr('y', -14)\n    } else {\n      this.label.attr('x', -10).attr('y', 1.5)\n    }\n\n    this.label.plain( `${this.tree.lineage.length}` )\n    return this.node\n  }\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/styles/_variables.scss'\n$mutedBlue: hsl(208, 40%, 75%)\n.svg-ancestor-collapse\n  cursor: pointer\n  // transition: transform 0.7s ease-in-out\n  rect\n    fill: white\n    stroke: white\n    transition: all 0.15s linear\n\n  circle\n    fill: $mutedBlue\n    transition: all 0.15s linear\n\n  // circle\n  //   fill: $white\n  //   stroke-width: 2\n  //   stroke: $grey-light\n  //   transition: all 0.15s linear\n\n  text\n    font-size: 16px\n    text-anchor: end\n    dominant-baseline: middle\n    fill: $mutedBlue\n    transition: fill 0.15s linear\n\n  &.horizontal text\n    text-anchor: middle\n\n  &:hover circle\n    fill: $blue\n\n  &:hover text\n    fill: $blue\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/ancestor-collapse.vue","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ed72c37e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ancestor-collapse.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ancestor-collapse.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ancestor-collapse.vue\"\n/* template */\nvar __vue_template__ = null\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/ancestor-collapse.vue\n// module id = null\n// module chunks = ","<script>\nimport { getTxnInfo, isMRCA } from '@/lib/taxonomy'\nexport default {\n  name: 'CondensedNode'\n  // , functional: true\n  , inject: [ 'svg' ]\n  , props: [ 'leaf', 'x', 'y', 'horizontal' ]\n  , data: () => ({\n    txnInfo: null\n    , otherCommonNames: []\n    , loading: false\n  })\n  , watch: {\n    leaf: {\n      handler( leaf ){\n        if ( !leaf ){ return }\n\n        getTxnInfo( leaf, { images: false } ).then( info => {\n          this.txnInfo = info\n          this.otherCommonNames = info.commonName\n        }).catch( ( err ) => this.$emit('error', err) )\n      }\n      , immediate: true\n    }\n  }\n  , computed: {\n    commonName(){\n      if ( this.isMRCA ){ return '' }\n      if ( !this.txnInfo || !this.txnInfo.vernacularNameList ){\n        if ( this.otherCommonNames ){\n          return this.otherCommonNames[0] || ''\n        }\n        return ''\n      }\n      return this.txnInfo.vernacularNameList\n    }\n    , scientificName(){\n      if ( !this.txnInfo ){ return '' }\n      return this.txnInfo.canonicalName ||\n        this.txnInfo.name ||\n        this.leaf.node_id || ''\n    }\n    , isMRCA(){\n      return this.leaf && isMRCA(this.leaf)\n    }\n  }\n  , beforeDestroy(){\n    this.node.off( 'click' )\n    this.node.remove()\n  }\n  , beforeMount(){\n    let scene = this.svg\n    this.node = scene.group().addClass('svg-condensed-node').move( 0, 0 )\n\n    this.node.circle(10).center(0, 0)\n\n    this.label = this.node.plain( '...' )\n\n    this.node.on( 'click', (e) => {\n      e.stopPropagation()\n      this.$emit( 'click', { leaf: this.leaf, x: this.x, y: this.y } )\n    })\n  }\n  , render( h ){\n    // this.node.move( this.xTween, this.yTween ).front()\n    this.node.style( 'transform', `translate3d(${this.x}px, ${this.y}px, 0)`).front()\n    if ( this.horizontal ){\n      this.label.removeClass('vertical')\n    } else {\n      this.label.addClass('vertical')\n    }\n    if ( this.commonName ){\n      this.label.plain( `${this.commonName}` )\n    } else {\n      this.label.plain( `(${this.scientificName})` )\n    }\n    return this.node\n  }\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/styles/_variables.scss'\n.svg-condensed-node\n  cursor: zoom-in\n  transition: transform 0.7s ease-in-out\n  circle\n    fill: desaturate(lighten($blue, 20), 50)\n    // stroke: white\n    transition: all 0.15s linear\n\n  text\n    font-family: $family-monospace\n    font-size: 16px\n    text-anchor: left\n    dominant-baseline: middle\n    fill: darken($blue, 15)\n    transition: fill 0.15s linear\n\n    transform: translateX(12px)\n\n    &.vertical\n      transform: rotateZ(90deg) translateX(12px)\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/condensed-node.vue","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-c8e4ae98\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./condensed-node.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./condensed-node.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./condensed-node.vue\"\n/* template */\nvar __vue_template__ = null\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/condensed-node.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-30005c28\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tail.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tail.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tail.vue\"\n/* template */\nvar __vue_template__ = null\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/tail.vue\n// module id = null\n// module chunks = ","<script>\nexport default {\n  name: 'Node'\n  // , functional: true\n  , inject: [ 'svg' ]\n  , props: [ 'leaf', 'x', 'y' ]\n  , data: () => ({\n\n  })\n  , beforeDestroy(){\n    this.tail.off( 'click' )\n    this.tail.remove()\n  }\n  , beforeMount(){\n    let tailRadius = 15\n    let scene = this.svg\n    this.tail = scene.group().addClass('svg-tail').move( this.x, this.y )\n    this.tail.circle(2 * tailRadius).center(0, 0)\n\n    // this.label = this.tail.plain( `${this.tree.lineage.length}` ).attr('y', 2)\n\n    this.tail.on( 'click', (e) => {\n      e.stopPropagation()\n      this.$emit( 'click', { tail: this.tail, leaf: this.leaf, x: this.x, y: this.y } )\n    })\n  }\n  , render( h ){\n    this.tail.move( this.x, this.y ).front()\n    // this.label.plain( `${this.tree.lineage.length}` )\n    return this.tail\n  }\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/styles/_variables.scss'\n.svg-tail\n  cursor: pointer\n\n  circle\n    fill: $white-ter\n    stroke-width: 2\n    stroke: $grey-light\n    transition: all 0.15s linear\n\n  text\n    font-size: 20px\n    text-anchor: middle\n    dominant-baseline: middle\n    fill: $grey-darker\n    transition: fill 0.15s linear\n\n  &:hover circle\n    fill: $cyan\n    stroke: $cyan\n\n  &:hover text\n    fill: $white\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/tail.vue","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0c654284\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./connection.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./connection.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./connection.vue\"\n/* template */\nvar __vue_template__ = null\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/connection.vue\n// module id = null\n// module chunks = ","<script>\n// import VueMixinTween from 'vue-mixin-tween'\n// import TWEEN from '@tweenjs/tween.js'\nexport default {\n  name: 'Connection'\n  , inject: [ 'svg' ]\n  , props: [ 'x1', 'y1', 'x2', 'y2', 'padding', 'horizontal' ]\n  , data: () => ({\n  })\n  , mixins: [\n    // VueMixinTween('x1', 700, TWEEN.Easing.Quadratic.InOut)\n    // , VueMixinTween('y1', 700, TWEEN.Easing.Quadratic.InOut)\n    // , VueMixinTween('x2', 700, TWEEN.Easing.Quadratic.InOut)\n    // , VueMixinTween('y2', 700, TWEEN.Easing.Quadratic.InOut)\n  ]\n  , beforeDestroy(){\n    this.node.remove()\n  }\n  , beforeMount(){\n    let scene = this.svg\n    this.node = scene.polyline([]).addClass('svg-connection')\n  }\n  , render( h ){\n    this.plot()\n    return this.node\n  }\n  , methods: {\n    plot(){\n      let spacing = this.padding\n      let x1 = this.x1\n      let y1 = this.y1\n      let x2 = this.x2\n      let y2 = this.y2\n      let line\n\n      if ( this.horizontal ){\n        line = [\n          [ x1, y1 ]\n          , [ x1 + spacing, y1 ]\n          , [ x1 + spacing, y2 ]\n          , [ x2, y2 ]\n        ]\n      } else {\n        line = [\n          [ x1, y1 ]\n          , [ x1, y1 + spacing ]\n          , [ x2, y1 + spacing ]\n          , [ x2, y2 ]\n        ]\n      }\n\n      this.node.plot( line ).back()\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\">\n@import '@/styles/_variables.scss'\n.svg-connection\n  fill: none\n  stroke-width: 3\n  stroke: hsl(208, 40%, 75%)\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/connection.vue","<template lang=\"pug\">\n.child-menu.dropdown(:style=\"{ transform: `translate(${x}px, ${y}px)`}\", :class=\"{ 'is-active': active }\")\n  .dropdown-menu\n    .dropdown-content\n      b-loading(:is-full-page=\"false\", :active=\"loading\")\n      .dropdown-item.heading.has-text-info Children\n      .dropdown-divider\n      a.dropdown-item(v-if=\"children.length\", v-for=\"child in children\", @click=\"$emit('select', child)\")\n        | {{ child.taxon ? child.taxon.name : child.node_id }}\n      .dropdown-item(v-if=\"!loading && !children.length\")\n        | None\n</template>\n\n<script>\nimport { getSubtree } from '@/lib/otol'\n\nexport default {\n  name: 'ChildMenu'\n  , props: {\n    'leaf': Object\n    , 'x': Number\n    , 'y': Number\n  }\n  , data: () => ({\n    children: []\n    , loading: false\n    , active: false\n  })\n  , watch: {\n    leaf(){\n      this.children = []\n      this.loading = true\n\n      if ( !this.leaf ){\n        this.active = false\n        return\n      }\n\n      this.active = true\n\n      getSubtree( this.leaf.node_id ).then( children => {\n        this.children = this.children.concat(children)\n        this.loading = false\n      }).catch( e => console.error(e) )\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.child-menu {\n  position: absolute;\n  top: 0;\n  left: 0;\n  .dropdown-menu {\n    position: relative;\n    top: 20px;\n    left: -50%;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/child-menu.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"child-menu dropdown\",class:{ 'is-active': _vm.active },style:({ transform: (\"translate(\" + _vm.x + \"px, \" + _vm.y + \"px)\")})},[_c('div',{staticClass:\"dropdown-menu\"},[_c('div',{staticClass:\"dropdown-content\"},[_c('b-loading',{attrs:{\"is-full-page\":false,\"active\":_vm.loading}}),_c('div',{staticClass:\"dropdown-item heading has-text-info\"},[_vm._v(\"Children\")]),_c('div',{staticClass:\"dropdown-divider\"}),_vm._l((_vm.children),function(child){return (_vm.children.length)?_c('a',{staticClass:\"dropdown-item\",on:{\"click\":function($event){return _vm.$emit('select', child)}}},[_vm._v(_vm._s(child.taxon ? child.taxon.name : child.node_id))]):_vm._e()}),(!_vm.loading && !_vm.children.length)?_c('div',{staticClass:\"dropdown-item\"},[_vm._v(\"None\")]):_vm._e()],2)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-614f94a0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tree/child-menu.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-614f94a0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./child-menu.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./child-menu.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./child-menu.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-614f94a0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./child-menu.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-614f94a0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/child-menu.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.tree\n  //- ChildMenu(:leaf=\"subtreeLeaf\", :x=\"childMenuX\", :y=\"childMenuY\", @select=\"$emit('add-node', arguments[0])\")\n  //- .lvl(v-for=\"level in columns\")\n  //-   .col(v-for=\"col in level\")\n  //-     template(v-if=\"!col\")\n  //-       .spacer\n  //-     .tol-col(v-if=\"col\")\n  //-       .box {{ col.tree.lineage.length }}\n  //-       TOLNodeCard(\n  //-         v-if=\"col.tree.leaf\"\n  //-         , :leaf=\"col.tree.leaf\"\n  //-       )\n  template(v-if=\"compactView\")\n    .tol-leaf(\n      v-for=\"branch in branches\"\n      , :class=\"{ 'horizontal': horizontal }\"\n      , :style=\"{ left: `${branch.x + branch.dx}px`, top: `${branch.y + branch.dy}px` }\"\n      , :tabindex=\"-1\"\n      )\n      Connection(v-if=\"!(branch.isRoot && !branch.tree.lineage.length)\", :horizontal=\"horizontal\", :x1=\"branch.px\", :y1=\"branch.py\", :x2=\"branch.x + branch.dx\", :y2=\"branch.y + branch.dy\", :padding=\"branch.dx || branch.dy\")\n      CondensedNode(v-if=\"!branch.tree.split.length\", :leaf=\"branch.tree.leaf\", :x=\"branch.x + branch.dx\", :y=\"branch.y\", :horizontal=\"horizontal\", @click=\"$emit('zoom-in', arguments[0])\")\n\n  transition-group(name=\"tree\", v-if=\"!compactView\", :css=\"transitions\")\n    .tol-leaf(\n      v-for=\"branch in branches\"\n      , :class=\"{ 'horizontal': horizontal }\"\n      , :key=\"branch.key\"\n      , :style=\"{ left: `${branch.x-(horizontal ? 0 : 0.5 * cardWidth) + branch.dx}px`, top: `${branch.y-(horizontal ? 0.5 * cardHeight : 0) + branch.dy}px`, width: cardWidth + 'px', height: cardHeight + 'px' }\"\n      , :tabindex=\"-1\"\n      , :data-ott=\"branch.tree.leaf.node_id\"\n      )\n      Connection(v-if=\"!(branch.isRoot && !branch.tree.lineage.length)\", :horizontal=\"horizontal\", :x1=\"branch.px\", :y1=\"branch.py\", :x2=\"branch.x + branch.dx\", :y2=\"branch.y + branch.dy\", :padding=\"(horizontal ? cardWidth : cardHeight) * 1.7\")\n      //- Node(v-if=\"branch.tree.lineage.length\", :tree=\"branch.tree\", :x=\"branch.x\", :y=\"branch.y\", @click=\"$emit('leaf-click', arguments[0])\")\n      AncestorCollapse(v-if=\"branch.tree.lineage.length\", :tree=\"branch.tree\", :x=\"branch.x\", :y=\"branch.y\", :horizontal=\"horizontal\", @click=\"$emit('leaf-click', arguments[0])\")\n\n      TOLLeafView(\n        :leaf=\"branch.tree.leaf\"\n        , :truncate-length=\"truncateLength\"\n        , :hide-images=\"hideImages\"\n        , :flap-style=\"flapStyle\"\n        , :horizontal=\"horizontal\"\n        , @remove=\"$emit( 'remove', branch.tree.leaf )\"\n        , @cut=\"$emit( 'cut', branch.tree )\"\n        , @error=\"$emit( 'error', arguments[0] )\"\n        , @add-node=\"$emit( 'add-node', arguments[0] )\"\n        , @remove-node=\"$emit( 'remove', arguments[0] )\"\n        )\n</template>\n\n<script>\nimport TOLLeafView from '@/components/tol-leaf-view'\nimport TOLMRCAView from '@/components/tol-mrca-view'\nimport Node from './node'\nimport AncestorCollapse from './ancestor-collapse'\nimport CondensedNode from './condensed-node'\nimport Tail from './tail'\nimport Connection from './connection'\nimport ChildMenu from './child-menu'\nimport _flatten from 'lodash/flatten'\n\nfunction getBranches( tree, opts, x = 0, y = 0, level = 0 ){\n\n  let hz = opts.horizontal\n  let height = opts.cardHeight\n  let nodeContainerSize = 0.5 * (hz ? height : opts.cardWidth) + opts.padding\n  let count = tree.nTips\n  let colstart = -(count - 1)\n  let branchSpacing = opts.branchSpacing\n  let branches = []\n\n  branches.push({\n    tree\n    , x\n    , y\n    , px: opts.px === undefined ? x : opts.px\n    , py: opts.py === undefined ? y : opts.py\n    , key: (tree.leaf.node_id || tree.leaf)\n    , dx: hz ? nodeContainerSize : 0\n    , dy: hz ? 0 : 0.75 * height\n    , isRoot: level === 0\n    , hasSplit: !!tree.split.length\n  })\n\n  if ( !tree.split.length ){\n    return branches\n  }\n\n  branches = branches.concat(\n    _flatten(\n      tree.split.map( (subtree, idx) => {\n        let col = subtree.nTips - 1\n        var xpos, ypos\n\n        if ( hz ){\n          xpos = x + branchSpacing + 1.3 * opts.cardWidth\n          ypos = y + (col + colstart) * nodeContainerSize\n        } else {\n          xpos = x + (col + colstart) * nodeContainerSize\n          ypos = y + branchSpacing + 1.3 * height\n        }\n\n        colstart = 2 * col + colstart + 2\n\n        return getBranches( subtree, {...opts, px: x, py: y}, xpos, ypos, level + 1 )\n      })\n    )\n  )\n\n  return branches\n}\n\nfunction appendToColumns( tree, columns, colOffset = 0, level = 0 ){\n  let colIndex = colOffset + tree.nTips - 1\n  let row = columns[ level ]\n  row[ colIndex ] = {\n    tree\n    , key: (tree.leaf ? tree.leaf.node_id : tree.lineage[0].node_id + level)\n    , isRoot: level === 0\n    , hasSplit: !!tree.split\n  }\n\n  if ( !tree.split ){\n    return columns\n  }\n\n  tree.split.forEach( (subtree, idx) => {\n    appendToColumns( subtree, columns, colOffset, level + 1 )\n    colOffset += subtree.nTips * 2\n  })\n\n  return columns\n}\n\nfunction getColumns( tree ){\n  // const nCols = tree.nTips * 2 - 1\n  const columns = Array( tree.depth ).fill(0).map(a => [])\n  appendToColumns( tree, columns )\n  return columns\n}\n\nexport default {\n  name: 'Tree'\n  , props: {\n    'tree': Object\n    , 'x': Number\n    , 'y': Number\n    , 'px': Number\n    , 'py': Number\n    , 'cardWidth': Number\n    , 'cardHeight': Number\n    , 'padding': Number\n    , 'branchSpacing': Number\n    , 'horizontal': Boolean\n    , 'flapStyle': Boolean\n    , 'hide-images': Boolean\n    , 'computedBranches': null\n    , 'compactView': Boolean\n    , 'transitions': {\n      type: Boolean\n      , default: true\n    }\n  }\n  , data: () => ({\n    subtreeLeaf: null\n    , childMenuX: 0\n    , childMenuY: 0\n  })\n  , components: {\n    Connection\n    , ChildMenu\n    , Node\n    , AncestorCollapse\n    , CondensedNode\n    , Tail\n    , TOLLeafView\n    , TOLMRCAView\n  }\n  , created () {\n    document.addEventListener('click', this.onDocumentClick)\n  }\n  , destroyed () {\n    // important to clean up!!\n    document.removeEventListener('click', this.onDocumentClick)\n  }\n  , computed: {\n    branches(){\n      let tree = this.tree\n      let x = this.x\n      let y = this.y\n      let b = getBranches(tree, {\n        cardWidth: this.compactView ? 0 : this.cardWidth\n        , cardHeight: this.compactView ? 0 : this.cardHeight\n        , branchSpacing: this.compactView ? 40 : this.branchSpacing\n        , padding: this.compactView ? 10 : this.padding\n        , horizontal: this.horizontal\n      }, x, y)\n      this.$emit('update:computedBranches', b)\n      return b\n    }\n\n    , columns(){\n      let tree = this.tree\n      let cols = getColumns( tree )\n      return cols\n    }\n\n    , truncateLength(){\n      return this.cardWidth / 9 | 0\n    }\n  }\n  , methods: {\n    openChildMenu({ x, y, leaf }){\n      this.childMenuX = x\n      this.childMenuY = y\n      this.subtreeLeaf = leaf\n    }\n    , onDocumentClick(){\n      this.subtreeLeaf = null\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '@/styles/_variables.scss';\n.child-menu {\n  position: absolute;\n  top: 0;\n  left: 0;\n  .dropdown-menu {\n    position: relative;\n    top: 20px;\n    left: -50%;\n  }\n}\n.lvl {\n  display: flex;\n  align-items: flex-start;\n  .col {\n    display: block;\n    margin: 0 -60px;\n    width: 260px;\n\n    &:first-child {\n      margin-left: 0;\n    }\n\n    &:last-child {\n      margin-right: 0;\n    }\n  }\n\n  .spacer {\n    height: 100px;\n  }\n}\n.tol-leaf {\n  position: absolute;\n  top: 0;\n  left: 0;\n  outline: none;\n\n  &.horizontal {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n  }\n\n  &:hover,\n  &:active,\n  &:focus {\n    z-index: 1;\n  }\n\n  .card {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n}\n.tree-move {\n  transition: all 0.7s ease-in-out;\n}\n.tree-enter-active, .tree-leave-active {\n  transition: all 0.7s ease-in-out;\n}\n.tree-enter, .tree-leave-to {\n  transition: all 0.7s ease-in-out;\n  opacity: 0;\n  top: -80px;\n}\n.simple {\n  background: $white;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/tree-display.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tree\"},[(_vm.compactView)?_vm._l((_vm.branches),function(branch){return _c('div',{staticClass:\"tol-leaf\",class:{ 'horizontal': _vm.horizontal },style:({ left: ((branch.x + branch.dx) + \"px\"), top: ((branch.y + branch.dy) + \"px\") }),attrs:{\"tabindex\":-1}},[(!(branch.isRoot && !branch.tree.lineage.length))?_c('Connection',{attrs:{\"horizontal\":_vm.horizontal,\"x1\":branch.px,\"y1\":branch.py,\"x2\":branch.x + branch.dx,\"y2\":branch.y + branch.dy,\"padding\":branch.dx || branch.dy}}):_vm._e(),(!branch.tree.split.length)?_c('CondensedNode',{attrs:{\"leaf\":branch.tree.leaf,\"x\":branch.x + branch.dx,\"y\":branch.y,\"horizontal\":_vm.horizontal},on:{\"click\":function($event){return _vm.$emit('zoom-in', arguments[0])}}}):_vm._e()],1)}):_vm._e(),(!_vm.compactView)?_c('transition-group',{attrs:{\"name\":\"tree\",\"css\":_vm.transitions}},_vm._l((_vm.branches),function(branch){return _c('div',{key:branch.key,staticClass:\"tol-leaf\",class:{ 'horizontal': _vm.horizontal },style:({ left: ((branch.x-(_vm.horizontal ? 0 : 0.5 * _vm.cardWidth) + branch.dx) + \"px\"), top: ((branch.y-(_vm.horizontal ? 0.5 * _vm.cardHeight : 0) + branch.dy) + \"px\"), width: _vm.cardWidth + 'px', height: _vm.cardHeight + 'px' }),attrs:{\"tabindex\":-1,\"data-ott\":branch.tree.leaf.node_id}},[(!(branch.isRoot && !branch.tree.lineage.length))?_c('Connection',{attrs:{\"horizontal\":_vm.horizontal,\"x1\":branch.px,\"y1\":branch.py,\"x2\":branch.x + branch.dx,\"y2\":branch.y + branch.dy,\"padding\":(_vm.horizontal ? _vm.cardWidth : _vm.cardHeight) * 1.7}}):_vm._e(),(branch.tree.lineage.length)?_c('AncestorCollapse',{attrs:{\"tree\":branch.tree,\"x\":branch.x,\"y\":branch.y,\"horizontal\":_vm.horizontal},on:{\"click\":function($event){return _vm.$emit('leaf-click', arguments[0])}}}):_vm._e(),_c('TOLLeafView',{attrs:{\"leaf\":branch.tree.leaf,\"truncate-length\":_vm.truncateLength,\"hide-images\":_vm.hideImages,\"flap-style\":_vm.flapStyle,\"horizontal\":_vm.horizontal},on:{\"remove\":function($event){return _vm.$emit( 'remove', branch.tree.leaf )},\"cut\":function($event){return _vm.$emit( 'cut', branch.tree )},\"error\":function($event){return _vm.$emit( 'error', arguments[0] )},\"add-node\":function($event){return _vm.$emit( 'add-node', arguments[0] )},\"remove-node\":function($event){return _vm.$emit( 'remove', arguments[0] )}}})],1)}),0):_vm._e()],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-720d7fba\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tree/tree-display.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-720d7fba\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tree-display.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tree-display.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tree-display.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-720d7fba\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./tree-display.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-720d7fba\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/tree-display.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.tree-canvas(ref=\"wrapper\")\n  .svg(ref=\"svg\")\n  .slot(:style=\"{ transform: `translate3d(${left}px, ${top}px, 0)` }\")\n    slot\n</template>\n\n<script>\nimport PubSub from '@/lib/pubsub'\nimport SVG from 'svg.js'\nimport Impetus from 'impetus'\nimport TWEEN from '@tweenjs/tween.js'\nimport _debounce from 'lodash/debounce'\n\n// var isTouch = false\n// window.addEventListener('touchstart', function firstTouch(){\n//   isTouch = true\n//   window.removeEventListener('touchstart', firstTouch)\n// }, false)\n\nfunction clamp( v, min, max ){\n  return Math.min(Math.max(v, min), max)\n}\n\n// Setup the animation loop.\nrequestAnimationFrame(function animate(time) {\n  requestAnimationFrame(animate)\n  TWEEN.update(time)\n})\n\nexport default {\n  name: 'TreeCanvas'\n  , props: {\n    'width': {\n      type: Number\n      , default: 0\n    }\n    , 'height': {\n      type: Number\n      , default: 0\n    }\n    , 'offsetX': {\n      type: Number\n      , default: 0\n    }\n    , 'offsetY': {\n      type: Number\n      , default: 0\n    }\n    , 'panDuration': {\n      type: Number\n      , default: 1000\n    }\n  }\n  , data: () => ({\n    x: 0\n    , y: 0\n    , elWidth: 0\n    , elHeight: 0\n  })\n  , provide(){\n    this.svgEl = document.createElement('svg')\n    this.svg = SVG(this.svgEl).size('100%', '100%').group()\n    return {\n      // provider: this.provider\n      svg: this.svg\n    }\n  }\n  , mounted(){\n\n    // function getScrollHeight(){\n    //   return document.documentElement.scrollHeight - document.documentElement.offsetHeight\n    // }\n\n    this.$refs.svg.appendChild(this.svgEl.children[0])\n    let impetus = this.impetus = new Impetus({\n      source: this.$el\n      , update: ( x, y ) => {\n        this.cancelPan()\n        this.setOffset( x, y )\n      }\n    })\n\n    const onResize = _debounce(() => {\n      this.onResize()\n      impetus.setBoundX( this.xBounds )\n      impetus.setBoundY( this.yBounds )\n    }, 200)\n\n    const onWheel = ( e ) => {\n      if ( !this.$el.contains(e.target) ){ return }\n      e.preventDefault()\n      let { x, y } = this.getClampedCoords( this.x - e.deltaX, this.y - e.deltaY )\n      impetus.setValues( x, y )\n      this.cancelPan()\n      this.setOffset( x, y )\n      return false\n    }\n\n    const preventDefault = e => e.stopPropagation()\n\n    window.addEventListener('wheel', onWheel, false)\n    window.addEventListener('touchmove', preventDefault, {passive: false})\n\n    this.$watch('width', onResize)\n    this.$watch('height', onResize)\n    window.addEventListener('resize', onResize)\n\n    this.$once( 'hook:beforeDestroy', () => {\n      window.removeEventListener('touchmove', preventDefault)\n      window.removeEventListener('wheel', onWheel)\n      window.removeEventListener('resize', onResize)\n      impetus.destroy()\n    })\n\n    onResize()\n  }\n  , watch: {\n    top: 'fixSVGPosition'\n    , left: 'fixSVGPosition'\n  }\n  , computed: {\n    left(){\n      return this.x + this.offsetX + this.elWidth * 0.5\n    }\n    , top(){\n      return this.y + this.offsetY + this.elHeight * 0.5\n    }\n    , xBounds(){\n      return [-(this.width + this.elWidth) * 0.5, (this.width + this.elWidth) * 0.5]\n    }\n    , yBounds(){\n      return [-(this.height + this.elHeight) * 0.5, (this.height + this.elHeight) * 0.5]\n    }\n  }\n  , methods: {\n    fixSVGPosition(){\n      let x = this.left\n      let y = this.top\n      this.svg.move(x, y)\n    }\n    , setOffset( x2, y2 ){\n      this.x = x2\n      this.y = y2\n      PubSub.$emit('tree:move')\n    }\n    , getClampedCoords( x, y ){\n      let [minX, maxX] = this.xBounds\n      let [minY, maxY] = this.yBounds\n      x = clamp(x, minX, maxX)\n      y = clamp(y, minY, maxY)\n      return { x, y }\n    }\n    , onResize(){\n      this.elWidth = this.$el.offsetWidth\n      this.elHeight = this.$el.offsetHeight\n    }\n    , panTo( x, y, animate = true ){\n      let coords = { x: this.x, y: this.y }\n\n      x = -x\n      y = -y\n      ;({ x, y } = this.getClampedCoords(x, y))\n\n      this.cancelPan()\n\n      if ( !animate ){\n        this.impetus.setValues( x, y )\n        this.setOffset( x, y )\n        return\n      }\n\n      this._activeTween = new TWEEN.Tween( coords )\n        .to({ x, y }, this.panDuration)\n        .easing(TWEEN.Easing.Quadratic.InOut)\n        .onUpdate(() => {\n          this.impetus.setValues( coords.x, coords.y )\n          this.setOffset( coords.x, coords.y )\n        })\n        .start()\n    }\n    , cancelPan(){\n      if ( this._activeTween ){\n        this._activeTween.stop()\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\">\n.tree-canvas\n  position: relative\n  width: 100%\n  height: 100%\n.slot\n  position: relative\n.svg\n  position: absolute\n  top: 0\n  left: 0\n  right: 0\n  bottom: 0\n  z-index: 0\n  cursor: move\n  svg\n    shape-rendering: cripsedges\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tree/tree-canvas.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"wrapper\",staticClass:\"tree-canvas\"},[_c('div',{ref:\"svg\",staticClass:\"svg\"}),_c('div',{staticClass:\"slot\",style:({ transform: (\"translate3d(\" + _vm.left + \"px, \" + _vm.top + \"px, 0)\") })},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6daa3cb8\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tree/tree-canvas.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6daa3cb8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tree-canvas.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tree-canvas.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./tree-canvas.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6daa3cb8\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./tree-canvas.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tree/tree-canvas.vue\n// module id = null\n// module chunks = ","// Build a tree from leafs\n// ---------------------------------------\nimport _clone from 'lodash/clone'\nimport _mapValues from 'lodash/mapValues'\nimport _find from 'lodash/find'\nimport _sortBy from 'lodash/sortBy'\n\nexport function assignDepth( tree, max = 0 ){\n  let depth\n\n  if ( !tree.split ){\n    depth = max + 1\n    tree.depth = depth\n    return depth\n  }\n\n  if ( tree.leaf ){\n    max += 1\n  }\n\n  depth = tree.split.reduce( (m, tree) => Math.max(m, assignDepth(tree, max)), max )\n  tree.depth = depth\n  return depth\n}\n\nfunction toBranch( leaf ){\n  return {\n    // starts from the \"top\" down. (cellular organisms -> ... -> humans)\n    lineage: [].concat(leaf.lineage).reverse()\n    , nTips: 1\n    , leaf: leaf\n    , split: []\n  }\n}\n\nfunction splitAt( tree, branch, i ){\n  branch = _mapValues( branch, _clone )\n\n  // create a cut with a fake leaf that we can fill in later\n  mergeAt( tree, toBranch( { node_id: tree.lineage[i].node_id } ), i )\n\n  branch.lineage.splice( 0, i + 1 )\n\n  tree.nTips++\n  tree.split.push( branch )\n  return 1\n}\n\nfunction mergeAt( tree, branch, i ){\n  branch = _mapValues( branch, _clone )\n\n  let lineage = tree.lineage.splice( 0, i )\n  let leaf = branch.leaf\n\n  tree.lineage.shift() // this is the same as \"leaf\"\n  branch.lineage = tree.lineage\n  branch.split = tree.split\n  branch.nTips = tree.nTips\n  branch.leaf = tree.leaf\n\n  tree.lineage = lineage\n  tree.split = [branch]\n  tree.leaf = leaf\n  return 0\n}\n\nfunction isInStem( stem, branch ){\n  let firstStemId = stem.lineage[0] ? stem.lineage[0].node_id : stem.leaf.node_id\n  let firstBranchId = branch.lineage[0] ? branch.lineage[0].node_id : branch.leaf.node_id\n  return firstStemId === firstBranchId\n}\n\nfunction joinTree( tree, branch ){\n\n  for ( let i = 0, l = tree.lineage.length; i < l; i++ ){\n    let treeParent = tree.lineage[ i ]\n    // check if branch can join the tree's branch\n    let branchParent = branch.lineage[ i ]\n    if ( !branchParent ){\n\n      if ( branch.leaf.node_id === treeParent.node_id ){\n        // the branch is in the middle of the current tree branch\n        return mergeAt( tree, branch, i )\n      } else {\n        // this means we found a new branch\n        return splitAt( tree, branch, i - 1 )\n      }\n    }\n    if ( treeParent.node_id !== branchParent.node_id ){\n      // this means we found a new branch\n      return splitAt( tree, branch, i - 1 )\n    }\n  }\n\n  if ( tree.leaf.node_id === branch.leaf.node_id ){\n    tree.leaf = branch.leaf\n    // edge case when we have already got a split node\n    // from previous merges, but also add the branch for it\n    return 0\n  }\n\n  if (\n    branch.lineage.length === tree.lineage.length ||\n    ( tree.lineage.length < branch.lineage.length &&\n      tree.leaf.node_id !== branch.lineage[tree.lineage.length].node_id )\n  ){\n    return splitAt( tree, branch, tree.lineage.length - 1 )\n  }\n\n  // if ( !tree.split ){\n  //   // this means it splits right at the leaf\n  //   branch = _mapValues( branch, _clone )\n  //   branch.lineage.splice( 0, tree.lineage.length )\n  //   tree.nTips++\n  //   tree.split = [{ lineage: [], nTips: 1, leaf: tree.leaf }, branch]\n  //   delete tree.leaf\n  //   return 1\n  // }\n\n  branch = _mapValues( branch, _clone )\n  branch.lineage.splice( 0, tree.lineage.length + 1 )\n\n  // if we got here, then we didn't find a place to join in the tree lineage...\n  // so let's check the splits\n  let stem = _find( tree.split, stem => isInStem( stem, branch ) )\n  if ( !stem ){\n    // if none of the splits match then add to this split\n    // #edgecases\n    tree.nTips++\n    tree.split.push( branch )\n    return 1\n  }\n\n  let tipsAdded = joinTree( stem, branch )\n  tree.nTips += tipsAdded\n  return tipsAdded\n}\n\n// function getNodeId( branch ){\n//   return branch.leaf ? branch.leaf.node_id : branch.lineage[0].node_id\n// }\n\nfunction treeSort( tree ){\n  if (!tree.split) { return }\n  tree.split.sort( (a, b) => a.depth > b.depth ? 1 : -1 )\n  tree.split.forEach( treeSort )\n}\n\nexport function buildReducedTree( leafs ){\n  // longest first\n  leafs = _sortBy(leafs, n => n.lineage.length).reverse()\n  var tree = toBranch( leafs[0] )\n\n  for ( let i = 1, l = leafs.length; i < l; i++ ){\n    joinTree( tree, toBranch( leafs[i] ) )\n  }\n\n  // assign a depth value to each branch\n  assignDepth( tree )\n\n  // Sorting improves the consistency\n  treeSort( tree )\n\n  return tree\n}\n\nexport function getChildren( branch ){\n  let children = branch.split.length ? branch.split.reduce( (ch, branch) => [...ch, ...getChildren(branch)], [] ) : []\n  return [ branch.leaf ].concat( children )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/tree-utils.js","<template lang=\"pug\">\ntransition(name=\"tree\", appear)\n  .tree(@click=\"openLeafContext = false\", v-if=\"tree\")\n    TreeCanvas(:width=\"width\", :height=\"height\", :offset-x=\"0\", :offset-y=\"0\", ref=\"treeCanvas\")\n      .parent-list.limit-dropdown.dropdown.is-active(\n        v-if=\"openLeafContext\"\n        , :style=\"{ top: leafContextY + 'px', left: leafContextX + 'px' }\"\n        , @wheel.stop=\"\"\n        , @touchstart.stop=\"\"\n        )\n        .dropdown-menu\n          .dropdown-content\n            .dropdown-item.heading.has-text-info Ancestors\n            a.dropdown-item(v-for=\"parent in leafContext.subtree.lineage\", :class=\"{ 'has-text-grey': !parent.taxon }\", @click=\"$emit('add-node', parent.node_id)\") {{ parent | nodeName }}\n      Tree(\n        :tree=\"tree\"\n        , :x=\"x\"\n        , :y=\"y\"\n        , :compactView=\"compactView\"\n        , :cardWidth=\"cardWidth\"\n        , :cardHeight=\"cardHeight\"\n        , :horizontal=\"horizontal\"\n        , :flap-style=\"flapStyle\"\n        , :hide-images=\"hideImages\"\n        , :padding=\"padding\"\n        , :branchSpacing=\"branchSpacing\"\n        , :transitions=\"transitions\"\n        , :computedBranches.sync=\"branches\"\n        , @remove=\"$emit('remove', arguments[0])\"\n        , @cut=\"$emit('cut', arguments[0])\"\n        , @leaf-click=\"showLeafDetails\"\n        , @add-node=\"$emit('add-node', arguments[0])\"\n        , @zoom-in=\"zoomTo(arguments[0].leaf.node_id)\"\n        , @error=\"$emit('error', arguments[0])\"\n        )\n</template>\n\n<script>\nimport PubSub from '@/lib/pubsub'\nimport Tree from '@/components/tree/tree-display'\nimport TreeCanvas from '@/components/tree/tree-canvas'\nimport { buildReducedTree } from '@/lib/tree-utils'\nimport _differenceBy from 'lodash/differenceBy'\nimport _find from 'lodash/find'\n\nexport default {\n  name: 'TOLTree'\n  , props: [ 'leafs', 'cardWidth', 'horizontal', 'hideImages', 'compactView', 'flapStyle' ]\n  , components: {\n    Tree\n    , TreeCanvas\n  }\n  , data: () => ({\n    leafContext: null\n    , openLeafContext: false\n    , leafContextX: 0\n    , leafContextY: 0\n    , padding: 10\n    , outerPadding: -80\n    , canvasX: 0\n    , transitions: true\n    , branches: [] // READ ONLY\n  })\n  , computed: {\n    x(){\n      if ( !this.tree || !this.$el ){ return 0 }\n      if ( this.horizontal ){ return -0.5 * this.width }\n      return 0\n    }\n\n    , y(){\n      if ( !this.tree || !this.$el ){ return 0 }\n      if ( this.horizontal ){ return 0 }\n      return -0.5 * this.height\n    }\n\n    , branchSpacing(){\n      return this.horizontal ? 160 : 80\n    }\n\n    , cardHeight(){\n      return this.flapStyle ? 110 : 90\n    }\n\n    , width(){\n      if ( !this.tree ){ return 0 }\n      if ( !this.horizontal ){\n        // vertical display\n        return 2 * this.outerPadding + this.tree.nTips * ( this.cardWidth + 2 * this.padding )\n      }\n      // horizontal display\n      return 2 * this.outerPadding + this.tree.depth * (this.cardWidth + this.branchSpacing)\n    }\n\n    , height(){\n      if ( !this.tree ){ return 0 }\n      if ( this.horizontal ){\n        // horizontal display\n        return 2 * this.outerPadding + this.tree.nTips * ( this.cardHeight + 2 * this.padding )\n      }\n      // vertical display\n      return 2 * this.outerPadding + this.tree.depth * (this.cardHeight + this.branchSpacing)\n    }\n\n    , tree(){\n      if (!this.leafs || !this.leafs.length){ return null }\n      return buildReducedTree( this.leafs )\n    }\n  }\n  , mounted(){\n    PubSub.$on('tree:pan-to', (nodeId) => this.$nextTick(() => this.panTo(nodeId)))\n  }\n  , beforeDestroy(){\n    PubSub.$off('tree:pan-to')\n  }\n  , watch: {\n    tree( newVal, oldVal ){\n      if ( oldVal === null ){\n        this.$nextTick( () => this.centerTree() )\n      }\n    }\n    , horizontal(){\n      this.centerTree()\n    }\n    , leafs( newVal, oldVal ){\n      if ( !oldVal || !oldVal.length ){ return }\n      let newLeafs = _differenceBy( newVal, oldVal, 'node_id' )\n      if ( !newLeafs.length ){ return }\n      this.$nextTick(() => {\n        this.panTo( newLeafs[0].node_id )\n      })\n    }\n    , compactView(){\n      if ( this.compactView ){\n        this.centerTree()\n      }\n    }\n  }\n  , methods: {\n    showLeafDetails( leaf ){\n      let height = leaf.subtree.lineage.length * 30\n      this.openLeafContext = true\n      this.leafContext = leaf\n      this.leafContextX = leaf.x + 30\n      this.leafContextY = leaf.y - 50 + Math.max(0, 50 - height)\n    }\n\n    , zoomTo( nodeId ){\n      this.$router.replace({ query: {...this.$route.query, c: false} })\n      this.transitions = false\n      this.$nextTick(() => {\n        this.panTo( nodeId )\n        this.transitions = true\n      })\n    }\n\n    , panTo( nodeId ){\n      let branch = _find(this.branches, { key: nodeId })\n      if ( !branch ){ return }\n      this.$refs.treeCanvas.panTo( branch.x, branch.y )\n    }\n\n    , centerTree(){\n      if ( !this.$refs.treeCanvas ){ return }\n\n      let x, y\n      let margin = 80\n\n      if ( this.horizontal ){\n        x = (this.$el.clientWidth - this.width) * 0.5 - margin\n        y = 0\n      } else {\n        x = 0\n        y = (this.$el.clientHeight - this.height) * 0.5 - margin\n      }\n\n      this.$refs.treeCanvas.panTo( x, y, false )\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import '@/styles/_variables.scss'\n.tree\n  position: relative\n  width: 100%\n  height: 100%\n  z-index: 1\n  opacity: 1\n.tree-enter-active, .tree-leave-active\n  transition: opacity 0.3s 0.2s linear\n.tree-enter, .tree-leave-to\n  opacity: 0\n\n.parent-list\n  position: absolute\n  //- for some reason ios doesn't like z-index\n  transform: translateZ(10px)\n  z-index: 100\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-tree.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"tree\",\"appear\":\"appear\"}},[(_vm.tree)?_c('div',{staticClass:\"tree\",on:{\"click\":function($event){_vm.openLeafContext = false}}},[_c('TreeCanvas',{ref:\"treeCanvas\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"offset-x\":0,\"offset-y\":0}},[(_vm.openLeafContext)?_c('div',{staticClass:\"parent-list limit-dropdown dropdown is-active\",style:({ top: _vm.leafContextY + 'px', left: _vm.leafContextX + 'px' }),on:{\"wheel\":function($event){$event.stopPropagation();},\"touchstart\":function($event){$event.stopPropagation();}}},[_c('div',{staticClass:\"dropdown-menu\"},[_c('div',{staticClass:\"dropdown-content\"},[_c('div',{staticClass:\"dropdown-item heading has-text-info\"},[_vm._v(\"Ancestors\")]),_vm._l((_vm.leafContext.subtree.lineage),function(parent){return _c('a',{staticClass:\"dropdown-item\",class:{ 'has-text-grey': !parent.taxon },on:{\"click\":function($event){return _vm.$emit('add-node', parent.node_id)}}},[_vm._v(_vm._s(_vm._f(\"nodeName\")(parent)))])})],2)])]):_vm._e(),_c('Tree',{attrs:{\"tree\":_vm.tree,\"x\":_vm.x,\"y\":_vm.y,\"compactView\":_vm.compactView,\"cardWidth\":_vm.cardWidth,\"cardHeight\":_vm.cardHeight,\"horizontal\":_vm.horizontal,\"flap-style\":_vm.flapStyle,\"hide-images\":_vm.hideImages,\"padding\":_vm.padding,\"branchSpacing\":_vm.branchSpacing,\"transitions\":_vm.transitions,\"computedBranches\":_vm.branches},on:{\"update:computedBranches\":function($event){_vm.branches=$event},\"update:computed-branches\":function($event){_vm.branches=$event},\"remove\":function($event){return _vm.$emit('remove', arguments[0])},\"cut\":function($event){return _vm.$emit('cut', arguments[0])},\"leaf-click\":_vm.showLeafDetails,\"add-node\":function($event){return _vm.$emit('add-node', arguments[0])},\"zoom-in\":function($event){return _vm.zoomTo(arguments[0].leaf.node_id)},\"error\":function($event){return _vm.$emit('error', arguments[0])}}})],1)],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2b87e7ec\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-tree.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2b87e7ec\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tol-tree.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-tree.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-tree.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2b87e7ec\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./tol-tree.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2b87e7ec\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-tree.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.search(@keyup.esc=\"closeOverlay\")\n  .overlay.scrollbars(v-show=\"overlayOpen\", tabindex=\"-1\")\n    .inner\n      .button.is-outlined.is-large.close(@click=\"closeOverlay\")\n        b-icon(icon=\"backburger\", size=\"is-medium\")\n      b-field\n        b-input(expanded, size=\"is-large\", v-model=\"searchEntry\", ref=\"overlayInput\", icon=\"magnify\", placeholder=\"eg. Snow Leopard\")\n        span.clear-btn.delete.is-large(@click=\"clear\")\n      .results\n        b-loading(:active=\"isFetching || isFetchingSci\", :is-full-page=\"false\")\n        .columns\n          .column\n            aside.menu\n              p.menu-label By Common Name...\n              ul.menu-list\n                li.item(v-for=\"result in results\")\n                  a(@click=\"selectResult( result )\")\n                    span.tag {{ result.rank || '?' }}\n                    span.common-names.has-text-info {{ result.commonNames }}\n                    span.scientific-name ({{ result.scientificName }})\n          .column\n            aside.menu\n              p.menu-label By Scientific Name...\n              ul.menu-list\n                li.item(v-for=\"result in scientificResults\")\n                  a(@click=\"selectResult( result )\")\n                    span.tag {{ result.rank || '?' }}\n                    span.scientific-name.has-text-info {{ result.scientificName }}\n                    span.common-names {{ result.commonNames }}\n        .empty-results-msg(v-if=\"searchEntry && !isFetching && !isFetchingSci && !results.length && !scientificResults.length\")\n          | No results. Is it spelled correctly?\n  b-field(expanded)\n    b-field\n      b-input(type=\"text\", @input=\"search\", @keyup.native=\"openOverlay\", v-model=\"searchEntry\", placeholder=\"start typing...\", icon=\"magnify\")\n      .control\n        .button(@click=\"openOverlay\")\n          span Search\n      //- b-autocomplete(\n      //-   placeholder=\"eg. Snow Leopard\"\n      //-   , icon=\"magnify\"\n      //-   , :keep-first=\"true\"\n      //-   , :data=\"results\"\n      //-   , v-model=\"searchEntry\"\n      //-   , :loading=\"isFetching\"\n      //-   , @input=\"search\"\n      //-   , @select=\"selectResult\"\n      //-   , expanded\n      //- )\n      //-   template(slot-scope=\"props\")\n      //-     .columns\n      //-       .common-names.column.is-half.has-text-info {{ props.option.commonNames }}\n      //-       .scientific-name.column.is-half {{ props.option.scientificName }}\n</template>\n\n<script>\nimport _debounce from 'lodash/debounce'\nimport _reject from 'lodash/reject'\nimport _uniqBy from 'lodash/uniqBy'\nimport cacher from '@/lib/cacher'\nimport { getNodeByName, getTxResultsByNames } from '@/lib/otol'\nimport * as gbif from '@/lib/gbif'\nimport * as wikidata from '@/lib/wikidata'\n\nfunction filterByOTLMatches( results ){\n  return getTxResultsByNames( results.map( el => el.canonicalName || el.scientificName ) )\n    .then( otlMatches => otlMatches.map( el => el.name ) )\n    .then( otlNames => results.filter( el =>\n      otlNames.indexOf(el.canonicalName || el.scientificName) > -1\n    ))\n}\n\nfunction removeDuplicates( results ){\n  return _uniqBy( results, 'canonicalName' )\n}\n\nfunction removeLackingVernacularName( results ){\n  return _reject( results, r => !r.vernacularNameList )\n}\n\nexport default {\n  name: 'TOLCommonNameSearch'\n  , props: ['leaves']\n  , components: {\n\n  }\n  , data: () => ({\n    results: []\n    , scientificResults: []\n    , searchEntry: ''\n    , source: 'gbif'\n    , isFetching: false\n    , isFetchingSci: false\n\n    , overlayOpen: false\n  })\n  , methods: {\n    openOverlay(){\n      this.overlayOpen = true\n      document.documentElement.style.overflow = 'hidden'\n      this.$refs.overlayInput.focus()\n    }\n\n    , closeOverlay(){\n      this.overlayOpen = false\n      document.documentElement.style.overflow = ''\n    }\n\n    , search( q ){\n      q = q.trim()\n      this.results = []\n      this.scientificResults = []\n\n      if (!q){ return }\n\n      this.openOverlay()\n\n      this.isFetching = true\n      this.isFetchingSci = true\n      this.execSearch( q )\n    }\n\n    , execSearch: _debounce(function( q ) {\n      let query\n\n      if ( this.source !== 'wikidata' ){\n        // gbif search\n        query = this.searchGbif( q )\n      } else {\n        // wikidata search\n        query = this.searchWikidata( q )\n      }\n\n      query\n        .then( results => {\n          this.results = results\n          this.isFetching = false\n        })\n        .catch( e => {\n          this.errorMsg(e)\n        })\n\n      this.searchGbif( q, false )\n        .then( results => {\n          this.scientificResults = results\n          this.isFetchingSci = false\n        })\n        .catch( e => {\n          this.errorMsg(e)\n        })\n    }, 500)\n\n    , searchGbif: cacher(function( q, commonName = true ){\n      let query = commonName\n        ? gbif.findByCommonName( q ).then( removeLackingVernacularName )\n        : gbif.findByScientificName( q )\n      return query\n        .then( removeDuplicates )\n        .then( filterByOTLMatches )\n        .then( results =>\n          results.map( el => ({\n            commonNames: el.vernacularNameList\n            , scientificName: el.canonicalName || el.scientificName\n            , rank: el.rank\n          }))\n        )\n    })\n\n    , searchWikidata( q ){\n      return wikidata.findInfoByCommonName( q, { limit: 10 } )\n        .then( filterByOTLMatches )\n        .then( results =>\n          results.map( el => ({\n            commonNames: el.commonName.join(', ')\n            , scientificName: el.scientificName.join(', ')\n            , rank: el.rank\n          }))\n        )\n    }\n\n    , selectResult( entry ){\n      this.closeOverlay()\n      getNodeByName( entry.scientificName )\n        .then( () => this.$emit( 'select', entry ) )\n        .catch( error => this.errorMsg(error) )\n    }\n\n    , errorMsg( error ){\n      this.$toast.open({\n        duration: 5000\n        , message: `Error: ${error.message}`\n        , type: 'is-danger'\n      })\n    }\n\n    , clear(){\n      this.searchEntry = ''\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"sass\">\n.common-names, .scientific-names\n  white-space: normal\n.overlay\n  position: fixed\n  top: 0\n  left: 0\n  right: 0\n  height: 100vh\n  background: rgba(255,255,255,1)\n  z-index: 20\n  overflow: auto\n  .close\n    position: absolute\n    top: 25px\n    left: 15px\n  .inner\n    margin: 25px 50px 25px 80px\n  .clear-btn\n    position: absolute\n    top: 36px\n    right: 58px\n    z-index: 5\n.results\n  position: relative\n  margin-top: 1.5em\n  min-height: 300px\n  .item\n    span\n      margin-right: 1ex\n      &:last-child\n        margin-right: 0\n\n.empty-results-msg\n  text-align: center\n  margin-top: 4em\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-common-name-search.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search\",on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.closeOverlay($event)}}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.overlayOpen),expression:\"overlayOpen\"}],staticClass:\"overlay scrollbars\",attrs:{\"tabindex\":\"-1\"}},[_c('div',{staticClass:\"inner\"},[_c('div',{staticClass:\"button is-outlined is-large close\",on:{\"click\":_vm.closeOverlay}},[_c('b-icon',{attrs:{\"icon\":\"backburger\",\"size\":\"is-medium\"}})],1),_c('b-field',[_c('b-input',{ref:\"overlayInput\",attrs:{\"expanded\":\"expanded\",\"size\":\"is-large\",\"icon\":\"magnify\",\"placeholder\":\"eg. Snow Leopard\"},model:{value:(_vm.searchEntry),callback:function ($$v) {_vm.searchEntry=$$v},expression:\"searchEntry\"}}),_c('span',{staticClass:\"clear-btn delete is-large\",on:{\"click\":_vm.clear}})],1),_c('div',{staticClass:\"results\"},[_c('b-loading',{attrs:{\"active\":_vm.isFetching || _vm.isFetchingSci,\"is-full-page\":false}}),_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('aside',{staticClass:\"menu\"},[_c('p',{staticClass:\"menu-label\"},[_vm._v(\"By Common Name...\")]),_c('ul',{staticClass:\"menu-list\"},_vm._l((_vm.results),function(result){return _c('li',{staticClass:\"item\"},[_c('a',{on:{\"click\":function($event){return _vm.selectResult( result )}}},[_c('span',{staticClass:\"tag\"},[_vm._v(_vm._s(result.rank || '?'))]),_c('span',{staticClass:\"common-names has-text-info\"},[_vm._v(_vm._s(result.commonNames))]),_c('span',{staticClass:\"scientific-name\"},[_vm._v(\"(\"+_vm._s(result.scientificName)+\")\")])])])}),0)])]),_c('div',{staticClass:\"column\"},[_c('aside',{staticClass:\"menu\"},[_c('p',{staticClass:\"menu-label\"},[_vm._v(\"By Scientific Name...\")]),_c('ul',{staticClass:\"menu-list\"},_vm._l((_vm.scientificResults),function(result){return _c('li',{staticClass:\"item\"},[_c('a',{on:{\"click\":function($event){return _vm.selectResult( result )}}},[_c('span',{staticClass:\"tag\"},[_vm._v(_vm._s(result.rank || '?'))]),_c('span',{staticClass:\"scientific-name has-text-info\"},[_vm._v(_vm._s(result.scientificName))]),_c('span',{staticClass:\"common-names\"},[_vm._v(_vm._s(result.commonNames))])])])}),0)])])]),(_vm.searchEntry && !_vm.isFetching && !_vm.isFetchingSci && !_vm.results.length && !_vm.scientificResults.length)?_c('div',{staticClass:\"empty-results-msg\"},[_vm._v(\"No results. Is it spelled correctly?\")]):_vm._e()],1)],1)]),_c('b-field',{attrs:{\"expanded\":\"expanded\"}},[_c('b-field',[_c('b-input',{attrs:{\"type\":\"text\",\"placeholder\":\"start typing...\",\"icon\":\"magnify\"},on:{\"input\":_vm.search},nativeOn:{\"keyup\":function($event){return _vm.openOverlay($event)}},model:{value:(_vm.searchEntry),callback:function ($$v) {_vm.searchEntry=$$v},expression:\"searchEntry\"}}),_c('div',{staticClass:\"control\"},[_c('div',{staticClass:\"button\",on:{\"click\":_vm.openOverlay}},[_c('span',[_vm._v(\"Search\")])])])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-64bce83c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-common-name-search.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-64bce83c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tol-common-name-search.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-common-name-search.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-common-name-search.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-64bce83c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./tol-common-name-search.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-64bce83c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-common-name-search.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.suggested-trees\n  // b-message(title=\"Note\", type=\"is-danger\", aria-close-label=\"Dismiss\")\n  //   | The tree server is experiencing issues so the explorer may not function. This should be fixed soon so check back another time.\n  .hero.is-primary\n    .hero-body\n      .container\n        h2.title Welcome!\n        p Here's a list of curated trees for you to start from...\n  article.suggestion.clickable(v-for=\"sug in suggestions\", @click=\"suggest(sug.ottIds)\")\n    .container\n      .media\n        figure.media-left\n          p.image\n            img(:src=\"sug.image\")\n        .media-content\n          .content\n            p.title {{ sug.title }}\n            p(v-html=\"sug.desc\")\n</template>\n\n<script>\nconst suggestions = [\n  {\n    title: `Darwin's Finches`\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Darwin%27s_finches_by_Gould.jpg/440px-Darwin%27s_finches_by_Gould.jpg'\n    , desc: `Darwin's finches (also known as the Galpagos finches) are a group of about fifteen species of passerine birds. They are well known for their remarkable diversity in beak form and function. They are often classified as the subfamily Geospizinae or tribe Geospizini. &mdash; Wikipedia`\n    , ottIds: [\n      'ott589951'\n      , 'ott589956'\n      , 'ott5859950'\n      , 'ott589953'\n      , 'ott589955'\n      , 'ott589959'\n      , 'ott419376'\n      , 'ott419363'\n      , 'ott422530'\n      , 'ott419367'\n      , 'ott963505'\n      , 'ott527328'\n      , 'ott589949'\n      , 'ott527327'\n      , 'ott992256'\n      , 'ott589943'\n    ]\n  }\n  , {\n    title: 'Our \"Cousins\"'\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/f/fb/Lightmatter_chimp.jpg'\n    , desc: 'Species of Ape near Humans on the tree of life'\n    , ottIds: [\n      'ott417969'\n      , 'ott417957'\n      , 'ott770315'\n      , 'ott417949'\n    ]\n  }\n  , {\n    title: 'Dinosaurs (and friends)'\n    , desc: 'Dinosaurs, their desendants, and near cousins.'\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/ab/Palais_de_la_Decouverte_Tyrannosaurus_rex_p1050042.jpg/320px-Palais_de_la_Decouverte_Tyrannosaurus_rex_p1050042.jpg'\n    , ottIds: [\n      'ott90215'\n      , 'ott81461'\n      , 'ott195672'\n      , 'ott195670'\n      , 'ott335582'\n      , 'ott639666'\n      , 'ott329823'\n      , 'ott35888'\n      , 'ott35887'\n    ]\n  }\n  , {\n    title: 'Cats'\n    , desc: 'The ones we keep as pets, and the... bigger ones'\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Two_littermates_cuddling_06.jpg/320px-Two_littermates_cuddling_06.jpg'\n    , ottIds: [\n      'ott763018'\n      , 'ott532117'\n      , 'ott563166'\n      , 'ott563159'\n      , 'ott886829'\n      , 'ott752759'\n      , 'ott42307'\n      , 'ott42314'\n      , 'ott563151'\n      , 'ott42324'\n      , 'ott42322'\n    ]\n  }\n  , {\n    title: 'Peculiar Animals'\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/f/f6/AxolotlBE.jpg'\n    , desc: 'A collection of strange looking animals.'\n    , ottIds: [\n      'ott984726'\n      , 'ott852676'\n      , 'ott679701'\n      , 'ott292504'\n      , 'ott1014156'\n      , 'ott71606'\n      , 'ott435643'\n      , 'ott721280'\n      , 'ott3632049'\n      , 'ott3652359'\n      , 'ott881015'\n      , 'ott464697'\n      , 'ott496400'\n      , 'ott50727'\n      , 'ott962377'\n    ]\n  }\n  , {\n    title: 'Prehistoric Animals that Survived'\n    , image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/Cheeeeeese_....._%2826732940981%29.jpg/320px-Cheeeeeese_....._%2826732940981%29.jpg'\n    , desc: 'A collection of animals that humans have found fossils of, and have survived the trials of natural selection to the present day.'\n    , ottIds: [\n      'ott73664'\n      , 'ott334633'\n      , 'ott801615'\n      , 'ott257929'\n      , 'ott754422'\n      , 'ott424193'\n      , 'ott511973'\n      , 'ott344064'\n      , 'ott35890'\n      , 'ott1093624'\n      , 'ott1084890'\n      , 'ott773491'\n      , 'ott3594707'\n      , 'ott616361'\n      , 'ott983579'\n      , 'ott962377'\n      , 'ott604022'\n      , 'ott316994'\n      , 'ott904117'\n      , 'ott469472'\n      , 'ott335582'\n      , 'ott397243'\n      , 'ott3617970'\n    ]\n  }\n  , {\n    title: 'Eat your veggies'\n    , desc: 'Closely related and good for you! Get to know your greens.'\n    , image: 'https://commons.wikimedia.org/wiki/Special:FilePath/Broccoli%20and%20cross%20section%20edit.jpg'\n    , ottIds: [\n      'ott833618'\n      , 'ott472637'\n      , 'ott309288'\n      , 'ott833642'\n      , 'ott526294'\n      , 'ott181145'\n      , 'ott181153'\n      , 'ott209048'\n      , 'ott505210'\n      , 'ott833623'\n      , 'ott833629'\n      , 'ott833638'\n      , 'ott951624'\n    ]\n  }\n]\n\nexport default {\n  name: 'TOLSuggestedTrees'\n  , props: []\n  , components: {\n  }\n  , data: () => ({\n    suggestions\n  })\n  , methods: {\n    suggest( ids ){\n      this.$emit('suggest', ids)\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"sass\">\n@import '@/styles/_variables.scss'\n.card\n  height: 100%\n.suggestion\n  transition: all .15s linear\n  @media screen and (min-width: $tablet)\n    &\n      padding-top: 0.5rem\n      padding-bottom: 0.5rem\n\n  .media-content\n    display: flex\n    flex-direction: row\n    align-items: center\n    align-self: stretch\n  .image\n    width: 256px\n    overflow: hidden\n    border-radius: 3px\n  .title\n    transition: all .15s linear\n  &:hover\n    color: $white\n    background: $blue\n    .title\n      color: $white\n\n@media screen and (max-width: $tablet)\n  .suggestion\n    .image\n      margin: auto\n      width: 100%\n  .media\n    flex-direction: column\n    .media-left\n      width: 100%\n      margin: 0\n    .media-content\n      padding: 3rem 1.5rem\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/tol-suggested-trees.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"suggested-trees\"},[_vm._m(0),_vm._l((_vm.suggestions),function(sug){return _c('article',{staticClass:\"suggestion clickable\",on:{\"click\":function($event){return _vm.suggest(sug.ottIds)}}},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"media\"},[_c('figure',{staticClass:\"media-left\"},[_c('p',{staticClass:\"image\"},[_c('img',{attrs:{\"src\":sug.image}})])]),_c('div',{staticClass:\"media-content\"},[_c('div',{staticClass:\"content\"},[_c('p',{staticClass:\"title\"},[_vm._v(_vm._s(sug.title))]),_c('p',{domProps:{\"innerHTML\":_vm._s(sug.desc)}})])])])])])})],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hero is-primary\"},[_c('div',{staticClass:\"hero-body\"},[_c('div',{staticClass:\"container\"},[_c('h2',{staticClass:\"title\"},[_vm._v(\"Welcome!\")]),_c('p',[_vm._v(\"Here's a list of curated trees for you to start from...\")])])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5938db8c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/tol-suggested-trees.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5938db8c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tol-suggested-trees.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-suggested-trees.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol-suggested-trees.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5938db8c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./tol-suggested-trees.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5938db8c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/tol-suggested-trees.vue\n// module id = null\n// module chunks = ","const docEl = document.documentElement\n\nexport const canFullscreen = (function(){\n  return docEl.requestFullscreen ||\n    docEl.webkitRequestFullscreen ||\n    docEl.mozRequestFullScreen ||\n    docEl.msRequestFullscreen\n})()\n\nexport function requestFullscreen( el ){\n  if (el.requestFullscreen) {\n    return el.requestFullscreen()\n  } else if (el.webkitRequestFullscreen) {\n    return el.webkitRequestFullscreen()\n  } else if (el.mozRequestFullScreen) {\n    return el.mozRequestFullScreen()\n  } else if (el.msRequestFullscreen) {\n    return el.msRequestFullscreen()\n  }\n}\n\nexport function exitFullscreen(){\n  if (document.exitFullscreen) {\n    document.exitFullscreen()\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen()\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen()\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen()\n  }\n}\n\nexport function getFullscreenEl(){\n  return document.fullscreenElement ||\n    document.webkitFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.msFullscreenElement\n}\n\nexport const fullscreenEventName = (function(){\n  const events = [\n    [ 'requestFullscreen', 'fullscreenchange' ]\n    , [ 'webkitRequestFullScreen', 'webkitfullscreenchange' ]\n    , [ 'mozRequestFullScreen', 'mozfullscreenchange' ]\n    , [ 'msRequestFullscreen', 'onmsfullscreenchange' ]\n  ]\n\n  for ( let e of events ){\n    if ( document.body[e[0]] ){\n      return e[1]\n    }\n  }\n\n  return null\n})()\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/fullscreen.js","<template lang=\"pug\">\n.app(:class=\"{ 'nav-open': navOpen }\")\n  nav.top-nav.box.is-radiusless.toolbar\n    .button.menu-button(@click=\"menuToggle\")\n      b-icon(:icon=\"navOpen ? 'chevron-up' : 'menu'\")\n    .toolbar-item\n      h1.title.main-title.is-pulled-left.clickable(@click=\"clear\")\n        | Tree of Life Explorer\n    .toolbar-item.search-container\n      TOLCommonNameSearch.search-box(@select=\"onSelect\")\n    .toolbar-right.top-controls\n      b-field(grouped)\n        b-field\n          .control\n            b-tooltip(label=\"Clear the tree\", type=\"is-dark\", position=\"is-bottom\")\n              .button.is-primary(@click=\"clear\")\n                b-icon(icon=\"home\")\n        b-field\n          .control\n            b-tooltip(label=\"Undo\", type=\"is-dark\", position=\"is-bottom\")\n              .button(@click=\"undo\")\n                b-icon(icon=\"undo\")\n          .control\n            b-tooltip(label=\"Redo\", type=\"is-dark\", position=\"is-bottom\")\n              .button(@click=\"redo\")\n                b-icon(icon=\"redo\")\n        b-field\n          b-dropdown.options-dropdown(:mobile-modal=\"false\")\n            .button(slot=\"trigger\")\n              span Options\n              b-icon(icon=\"menu-down\")\n            b-dropdown-item(@click=\"setOption('fs', !flapStyle)\")\n              b-icon(:icon=\"flapStyle ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'\")\n              span Uncover Images\n            b-dropdown-item(@click=\"setOption('im', !hideImages)\")\n              b-icon(:icon=\"hideImages ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'\")\n              span Hide Images\n            b-dropdown-item(@click=\"setOption('h', !horizontalMode)\")\n              b-icon(:icon=\"horizontalMode ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'\")\n              span Horizontal Tree\n            b-dropdown-item(@click=\"setOption('w', !wideMode)\")\n              b-icon(:icon=\"wideMode ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'\")\n              span Wide Cards\n\n          //- .control\n          //-   b-tooltip(:label=\"wideMode ? 'Smaller cards' : 'Bigger cards'\", type=\"is-dark\", position=\"is-bottom\")\n          //-     .button(@click=\"setOption('w', !wideMode)\")\n          //-       b-icon(:icon=\"wideMode? 'arrow-collapse-horizontal' : 'arrow-expand-horizontal'\")\n          //- .control\n          //-   b-tooltip(:label=\"'Change Tree Orientation'\", type=\"is-dark\", position=\"is-bottom\")\n          //-     .button(@click=\"setOption('h', !horizontalMode)\")\n          //-       b-icon(icon=\"tournament\", :custom-class=\"horizontalMode ? 'icon-anim icon-180' : 'icon-anim icon-270'\")\n          //- .control\n          //-   b-tooltip(:label=\"hideImages ? 'Show Images' : 'Hide Images'\", type=\"is-dark\", position=\"is-bottom\")\n          //-     .button(@click=\"setOption('im', !hideImages)\")\n          //-       b-icon(:icon=\"hideImages ? 'image-plus' : 'image-off'\")\n        b-field\n          .control\n            b-tooltip(label=\"Share this tree\", type=\"is-dark\", position=\"is-bottom\")\n              .button.is-success(@click=\"share\")\n                b-icon(icon=\"share\")\n          .control\n            b-tooltip(label=\"Take a helpful tour\", type=\"is-dark\", position=\"is-bottom\", data-v-tour=\"start\")\n              .button.is-dark(@click=\"startTour\", :class=\"{ pulsing: tourMessage }\")\n                b-icon(icon=\"help-network\")\n\n      .meta-info\n        a(@click=\"showMetaInfo\") About this app\n\n  .below-nav\n    .tol-wrapper(v-show=\"!treeIsEmpty\")\n      TOLTree(\n        :leafs=\"leafs\"\n        , :card-width=\"cardWidth\"\n        , :hide-images=\"hideImages\"\n        , :compactView=\"compactView\"\n        , :horizontal=\"horizontalMode\"\n        , :flap-style=\"flapStyle\"\n        , @remove=\"onRemoveLeaf\"\n        , @cut=\"cutBranch\"\n        , @add-node=\"addNode\"\n        , @error=\"onError\"\n      )\n    .wrapper\n      .inner\n        b-loading(:is-full-page=\"false\", :active=\"loading\")\n        .empty-state(v-show=\"treeIsEmpty\")\n          .suggested\n            TOLSuggestedTrees(@suggest=\"setLeafs\")\n\n  .bottom-controls\n    b-field\n      .control\n        b-tooltip(:label=\"compactView ? 'Normal View' : 'Compact View'\", type=\"is-dark\", position=\"is-left\")\n          .button.button-compact-view.is-medium(@click=\"setOption('c', !compactView)\")\n            b-icon(:icon=\"compactView ? 'magnify-plus' : 'magnify-minus'\")\n      .control(v-if=\"canFullscreen\")\n        b-tooltip(:label=\"isInFullscreen ? 'Exit Fullscreen' : 'Enter Fullscreen'\", type=\"is-dark\", position=\"is-left\")\n          .button.is-medium(@click=\"fullscreenToggle\")\n            b-icon(:icon=\"isInFullscreen ? 'compress' : 'expand'\", pack=\"fas\")\n</template>\n\n<script>\nimport PubSub from '@/lib/pubsub'\nimport TOLTree from '@/components/tol-tree'\nimport TOLCommonNameSearch from '@/components/tol-common-name-search'\nimport TOLSuggestedTrees from '@/components/tol-suggested-trees'\nimport { getNodeByName } from '@/lib/otol'\n// import { findByName } from '@/lib/gbif'\nimport { getLeaf } from '@/lib/taxonomy'\nimport { getChildren } from '@/lib/tree-utils'\nimport { getFullscreenEl, requestFullscreen, exitFullscreen, canFullscreen, fullscreenEventName } from '@/lib/fullscreen'\nimport { copyToClipboard } from '@/lib/utils'\nimport _difference from 'lodash/difference'\nimport _castArray from 'lodash/castArray'\nimport _uniq from 'lodash/uniq'\nimport _startsWith from 'lodash/startsWith'\nimport _filter from 'lodash/filter'\nimport _union from 'lodash/union'\nimport _debounce from 'lodash/debounce'\nimport Promise from 'bluebird'\n\nexport default {\n  name: 'page-tol'\n  , props: {\n    'ids': {\n      type: Array\n      , default: () => []\n    }\n    , wideMode: {\n      type: Boolean\n      , default: false\n    }\n    , horizontalMode: {\n      type: Boolean\n      , default: true\n    }\n    , hideImages: {\n      type: Boolean\n      , default: false\n    }\n    , compactView: {\n      type: Boolean\n      , default: false\n    }\n    , flapStyle: {\n      type: Boolean\n      , default: false\n    }\n  }\n  , components: {\n    TOLTree\n    , TOLCommonNameSearch\n    , TOLSuggestedTrees\n  }\n  , data: () => ({\n    leafs: []\n    , canFullscreen\n    , navOpen: true\n    , loading: false\n    , isInFullscreen: false\n    , tourMessage: false\n  })\n  , created(){\n    if ( fullscreenEventName ){\n      window.addEventListener(fullscreenEventName, () => {\n        this.isInFullscreen = !!(getFullscreenEl())\n      }, { passive: true })\n    }\n  }\n  , computed: {\n    cardWidth(){\n      return this.wideMode ? 260 : 160\n    }\n    , treeIsEmpty(){\n      return !this.leafs.length\n    }\n  }\n  , watch: {\n    ids: {\n      handler( ids, oldIds ){\n        if ( !oldIds || !oldIds.length ){\n          // on first load or tree change... set loading\n          this.loading = true\n        }\n        this.onIdsChanged( this.ids )\n      }\n      , immediate: true\n    }\n  }\n  , mounted(){\n    if (this.$el.offsetWidth < 780){\n      setTimeout(() => {\n        this.navOpen = false\n      }, 1000)\n    }\n\n    // welcome message\n    if ( this.ids && this.ids.length ){ return }\n    setTimeout(() => {\n      const delay = 10000\n      this.tourMessage = true\n      this.$snackbar.open({\n        message: 'Hi there! If you would like me to show you around, click the tour button highlighted above!'\n        , position: 'is-top-right'\n        , duration: delay\n        , type: 'is-white'\n        , actionText: 'go away'\n      })\n      setTimeout( () => {\n        this.tourMessage = false\n      }, delay)\n    }, 2000)\n  }\n  , methods: {\n\n    onError( e ){\n      console.error( e )\n      this.showError( e )\n    }\n\n    , showError: _debounce(function( e ){\n      var message = ''\n      if ( e.message === 'Network Error' ){\n        message = 'Trouble connecting with database! Sorry! Things might not work. Try refreshing...'\n      } else {\n        message = e.message\n      }\n\n      this.$toast.open({\n        message\n        , type: 'is-danger'\n        , duration: 10 * 1000\n        , queue: false\n      })\n    }, 100)\n\n    , undo(){\n      this.$router.back()\n    }\n\n    , redo(){\n      this.$router.forward()\n    }\n\n    , setLeafs( ids ){\n      this.$router.push({ query: { ...this.$route.query, ids: _uniq( ids ) } })\n    }\n\n    , addLeaf( ids ){\n      ids = _castArray( ids )\n      ids = _filter( ids, id => _startsWith(id, 'ott') || _startsWith(id, 'mrca') )\n      ids = _union( ids, this.ids )\n      this.$router.push({ query: { ...this.$route.query, ids } })\n    }\n\n    , removeLeaf( id ){\n      this.$router.push({ query: { ...this.$route.query, ids: _difference( this.ids, _castArray(id) ) } })\n    }\n\n    , onRemoveLeaf( leaf ){\n      this.removeLeaf( leaf.node_id || leaf )\n    }\n\n    , onSelect( entry ){\n      getNodeByName( entry.scientificName ).then( (node) => {\n        this.addLeaf( node.node_id )\n      }).catch( e => this.onError( e ) )\n    }\n\n    , cutBranch( branch ){\n      let children = getChildren( branch )\n      this.removeLeaf( children.map( ch => ch.node_id ) )\n    }\n\n    , addNode( nodeId ){\n      return this.addLeaf( nodeId )\n    }\n\n    , onIdsChanged( ids ){\n      if ( !ids ){ return }\n      Promise.map( ids, (id) =>\n        getLeaf(id).catch(err => {\n          this.onError(err)\n          return false\n        })\n      )\n        .filter( leaf => leaf )\n        .then( leafs => (this.leafs = leafs) )\n        .catch( e => this.onError( e ) )\n        .finally( () => { this.loading = false } )\n    }\n\n    , clear(){\n      this.$router.push({ query: { ...this.$route.query, ids: [] } })\n    }\n\n    , showMetaInfo(){\n      this.$root.showMetaInfo = true\n    }\n\n    , menuToggle(){\n      this.navOpen = !this.navOpen\n    }\n\n    , fullscreenToggle(){\n      let fs = this.isInFullscreen\n\n      if ( fs ){\n        exitFullscreen()\n      } else {\n        requestFullscreen( document.documentElement )\n      }\n    }\n\n    , setOption( name, val ){\n      this.$router.replace({ query: { ...this.$route.query, [name]: (val | 0) } })\n    }\n\n    , share(){\n      copyToClipboard( window.location )\n      this.$toast.open({\n        message: 'URL copied to clipboard!'\n        , type: 'is-success'\n        , position: 'is-top-right'\n      })\n    }\n\n    , startTour(){\n      PubSub.$emit('tour:start')\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"sass\">\n@import '@/styles/_variables.scss'\n$topNavHeight: 100px\n.main-title\n  height: 45px\n  width: 166px\n//   position: relative\n//   font: 0px/0\n//   margin: 0\n//   margin-right: 1rem\n//   font-weight: 700\n//   color: $blue\n//   text-shadow: 1px 1px 1px lighten($blue, 30)\n//\n//   padding-left: 2rem\n//   // &:before\n//   //   content: 'The'\n//   //   position: absolute\n//   //   top: 3px\n//   //   left: 0\n//   //   font-size: 1rem\n.app\n  display: flex\n  flex-direction: column\n  align-items: stretch\n  min-height: 100vh\n.bottom-controls\n  position: fixed\n  bottom: 0\n  right: 0\n  z-index: 22\n  .button\n    border-radius: 3px 0 0 0\n.below-nav\n  position: relative\n  flex: 1\n  margin-top: $topNavHeight\n.tol-wrapper\n  position: fixed\n  top: $topNavHeight\n  left: 0\n  right: 0\n  bottom: 0\n  z-index: 1\n.search-box\n.wrapper\n  flex: 1\n  overflow: hidden\n  display: flex\n  align-items: stretch\n  .inner\n    position: relative\n    flex: 1\n  .tree\n    min-height: 100%\n    margin: auto\n.top-nav\n  position: fixed\n  top: 0\n  left: 0\n  right: 0\n  z-index: 30\n  display: flex\n  padding: 1rem 1.25rem\n\n  .field\n    margin-bottom: 0\n  .switch\n    height: 100%\n  .meta-info\n    border-left: 1px solid $grey-lighter\n    margin-left: 1rem\n    padding-left: 1rem\n\n  .menu-button\n    display: none\n.welcome-msg\n  padding: 3rem 1.5rem 0\n  .splash-image\n    padding: 0 4em\n\n.options-dropdown .dropdown-item\n  display: flex\n  align-items: center\n  flex-direction: row\n  .icon\n    margin-right: 1ex\n@media screen and (max-width: 820px)\n  .below-nav\n    margin-top: 0\n  .tol-wrapper\n    top: 0\n  .top-nav\n    flex-wrap: wrap\n    transform: translate3d(0, -120px, 0)\n    transition: transform 0.3s ease-in-out\n    .nav-open &\n      transform: translate3d(0, 0, 0)\n    .menu-button\n      display: block\n      position: absolute\n      bottom: -36px\n      left: 0\n    .toolbar-item\n      margin-bottom: 1rem\n    .search-container\n      display: flex\n      justify-content: flex-end\n    .toolbar-item,\n    .toolbar-right\n      display: flex\n      flex-direction: row\n    .toolbar-right\n      width: 100%\n      flex-direction: row-reverse\n      & > *\n        flex: 1\n      .meta-info\n        border: none\n        margin-left: 0\n        padding-left: 0\n      .field\n        justify-content: flex-end\n@media screen and (max-width: 420px)\n  .tol-wrapper\n    top: 0\n  .top-nav\n    transform: translate3d(0, -172px, 0)\n    .toolbar-right\n      .meta-info\n        position: absolute\n        top: 20px\n        right: 1.5rem\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/tol.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app\",class:{ 'nav-open': _vm.navOpen }},[_c('nav',{staticClass:\"top-nav box is-radiusless toolbar\"},[_c('div',{staticClass:\"button menu-button\",on:{\"click\":_vm.menuToggle}},[_c('b-icon',{attrs:{\"icon\":_vm.navOpen ? 'chevron-up' : 'menu'}})],1),_c('div',{staticClass:\"toolbar-item\"},[_c('h1',{staticClass:\"title main-title is-pulled-left clickable\",on:{\"click\":_vm.clear}},[_vm._v(\"Tree of Life Explorer\")])]),_c('div',{staticClass:\"toolbar-item search-container\"},[_c('TOLCommonNameSearch',{staticClass:\"search-box\",on:{\"select\":_vm.onSelect}})],1),_c('div',{staticClass:\"toolbar-right top-controls\"},[_c('b-field',{attrs:{\"grouped\":\"grouped\"}},[_c('b-field',[_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":\"Clear the tree\",\"type\":\"is-dark\",\"position\":\"is-bottom\"}},[_c('div',{staticClass:\"button is-primary\",on:{\"click\":_vm.clear}},[_c('b-icon',{attrs:{\"icon\":\"home\"}})],1)])],1)]),_c('b-field',[_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":\"Undo\",\"type\":\"is-dark\",\"position\":\"is-bottom\"}},[_c('div',{staticClass:\"button\",on:{\"click\":_vm.undo}},[_c('b-icon',{attrs:{\"icon\":\"undo\"}})],1)])],1),_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":\"Redo\",\"type\":\"is-dark\",\"position\":\"is-bottom\"}},[_c('div',{staticClass:\"button\",on:{\"click\":_vm.redo}},[_c('b-icon',{attrs:{\"icon\":\"redo\"}})],1)])],1)]),_c('b-field',[_c('b-dropdown',{staticClass:\"options-dropdown\",attrs:{\"mobile-modal\":false}},[_c('div',{staticClass:\"button\",attrs:{\"slot\":\"trigger\"},slot:\"trigger\"},[_c('span',[_vm._v(\"Options\")]),_c('b-icon',{attrs:{\"icon\":\"menu-down\"}})],1),_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.setOption('fs', !_vm.flapStyle)}}},[_c('b-icon',{attrs:{\"icon\":_vm.flapStyle ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'}}),_c('span',[_vm._v(\"Uncover Images\")])],1),_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.setOption('im', !_vm.hideImages)}}},[_c('b-icon',{attrs:{\"icon\":_vm.hideImages ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'}}),_c('span',[_vm._v(\"Hide Images\")])],1),_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.setOption('h', !_vm.horizontalMode)}}},[_c('b-icon',{attrs:{\"icon\":_vm.horizontalMode ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'}}),_c('span',[_vm._v(\"Horizontal Tree\")])],1),_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.setOption('w', !_vm.wideMode)}}},[_c('b-icon',{attrs:{\"icon\":_vm.wideMode ? 'checkbox-marked-circle' : 'checkbox-blank-circle-outline'}}),_c('span',[_vm._v(\"Wide Cards\")])],1)],1)],1),_c('b-field',[_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":\"Share this tree\",\"type\":\"is-dark\",\"position\":\"is-bottom\"}},[_c('div',{staticClass:\"button is-success\",on:{\"click\":_vm.share}},[_c('b-icon',{attrs:{\"icon\":\"share\"}})],1)])],1),_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":\"Take a helpful tour\",\"type\":\"is-dark\",\"position\":\"is-bottom\",\"data-v-tour\":\"start\"}},[_c('div',{staticClass:\"button is-dark\",class:{ pulsing: _vm.tourMessage },on:{\"click\":_vm.startTour}},[_c('b-icon',{attrs:{\"icon\":\"help-network\"}})],1)])],1)])],1),_c('div',{staticClass:\"meta-info\"},[_c('a',{on:{\"click\":_vm.showMetaInfo}},[_vm._v(\"About this app\")])])],1)]),_c('div',{staticClass:\"below-nav\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.treeIsEmpty),expression:\"!treeIsEmpty\"}],staticClass:\"tol-wrapper\"},[_c('TOLTree',{attrs:{\"leafs\":_vm.leafs,\"card-width\":_vm.cardWidth,\"hide-images\":_vm.hideImages,\"compactView\":_vm.compactView,\"horizontal\":_vm.horizontalMode,\"flap-style\":_vm.flapStyle},on:{\"remove\":_vm.onRemoveLeaf,\"cut\":_vm.cutBranch,\"add-node\":_vm.addNode,\"error\":_vm.onError}})],1),_c('div',{staticClass:\"wrapper\"},[_c('div',{staticClass:\"inner\"},[_c('b-loading',{attrs:{\"is-full-page\":false,\"active\":_vm.loading}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.treeIsEmpty),expression:\"treeIsEmpty\"}],staticClass:\"empty-state\"},[_c('div',{staticClass:\"suggested\"},[_c('TOLSuggestedTrees',{on:{\"suggest\":_vm.setLeafs}})],1)])],1)])]),_c('div',{staticClass:\"bottom-controls\"},[_c('b-field',[_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":_vm.compactView ? 'Normal View' : 'Compact View',\"type\":\"is-dark\",\"position\":\"is-left\"}},[_c('div',{staticClass:\"button button-compact-view is-medium\",on:{\"click\":function($event){return _vm.setOption('c', !_vm.compactView)}}},[_c('b-icon',{attrs:{\"icon\":_vm.compactView ? 'magnify-plus' : 'magnify-minus'}})],1)])],1),(_vm.canFullscreen)?_c('div',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"label\":_vm.isInFullscreen ? 'Exit Fullscreen' : 'Enter Fullscreen',\"type\":\"is-dark\",\"position\":\"is-left\"}},[_c('div',{staticClass:\"button is-medium\",on:{\"click\":_vm.fullscreenToggle}},[_c('b-icon',{attrs:{\"icon\":_vm.isInFullscreen ? 'compress' : 'expand',\"pack\":\"fas\"}})],1)])],1):_vm._e()])],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a6d1120c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/tol.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a6d1120c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./tol.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./tol.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a6d1120c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./tol.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-a6d1120c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/tol.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport PageTOL from '@/pages/tol'\nimport _castArray from 'lodash/castArray'\nimport _uniq from 'lodash/uniq'\nimport _compact from 'lodash/compact'\nimport _get from 'lodash/get'\n\nVue.use(Router)\n\nfunction getOption( query, name, def = 0 ){\n  return !!parseInt(_get(query, name, def))\n}\n\nexport default new Router({\n  routes: [\n    {\n      path: '/'\n      , name: 'index'\n      , component: PageTOL\n      , props: (route) => ({\n        ids: _compact(_uniq(_castArray(route.query.ids)))\n        , wideMode: getOption(route.query, 'w')\n        , horizontalMode: getOption(route.query, 'h', 1)\n        , hideImages: getOption(route.query, 'im')\n        , compactView: getOption(route.query, 'c')\n        , flapStyle: getOption(route.query, 'fs')\n      })\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","<template>\n  <div id=\"app\">\n    <slot/>\n    <router-view/>\n    <v-tour name=\"TOLTour\" :steps=\"TourSteps\" :callbacks=\"TourCallbacks\"></v-tour>\n  </div>\n</template>\n\n<script>\nimport PubSub from '@/lib/pubsub'\nimport router from './router'\nimport _throttle from 'lodash/throttle'\n\nconst txnCats = 'ott563159'\nconst TourTree = [\n  'ott532117'\n  , 'ott563166'\n  , 'ott770315'\n  , txnCats\n]\n\nconst TourSteps = [\n  {\n    target: '[data-v-tour=\"start\"]'\n    , content: `Welcome to the MinuteLabs.io Tree of Life Explorer! Let's show you around...`\n    , onEnter(){\n      // console.log('start')\n    }\n    , params: {\n      // placement: 'top'\n    }\n  }\n  , {\n    target: '[data-v-tour=\"start\"]'\n    , content: `Below is a tree that shows the connections between different species.`\n    , onEnter({ type }){\n      if ( type !== 'next' ){ return }\n      router.replace({ query: { ids: TourTree } })\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"]`\n    , content: 'This is a \"clade node\". It can represent any <a href=\"https://en.wikipedia.org/wiki/Taxonomic_rank\" target=\"_blank\">taxonomic rank</a> (species, family, genus, ...). In this case, it represents the Cat <em>Family</em>.'\n    , onEnter(){\n      PubSub.$emit('tree:pan-to', txnCats)\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"]`\n    , content: 'The node shows the common name (if it has one), followed by the scientific name.'\n    , onEnter(){\n      PubSub.$emit('tree:pan-to', txnCats)\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"]`\n    , content: 'Hovering (or tapping in touchscreens) will show buttons related to this node.'\n    , onEnter(){\n      const el = document.querySelector('.tol-leaf[data-ott=\"ott563159\"]')\n      el.classList.add('tour-hover')\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"] .overlay-btn.descendants-btn`\n    , content: `This button will show the descendants (children) of this clade. There are a bunch for Cats!`\n    , params: {\n      placement: 'left'\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"] .overlay-btn.cut-btn`\n    , content: `You can delete this whole branch of the tree by using this button.`\n    , params: {\n      placement: 'bottom'\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"] .overlay-btn.info-btn`\n    , content: `You can see more information about the taxon with this button.`\n    , params: {\n      placement: 'bottom'\n    }\n  }\n  , {\n    target: `.tol-leaf[data-ott=\"${txnCats}\"] .overlay-btn.remove-btn`\n    , content: `This removes the card.`\n    , params: {\n      placement: 'bottom'\n    }\n    , onLeave(){\n      const el = document.querySelector('.tol-leaf[data-ott=\"ott563159\"]')\n      el.classList.remove('tour-hover')\n    }\n  }\n  , {\n    target: `.svg-ancestor-collapse[data-ott=\"${txnCats}\"]`\n    , content: `This icon shows how many ancestors are between the Cat Family clade and the next node shown up the tree.`\n  }\n  , {\n    target: '.options-dropdown'\n    , content: `Use this button to control how the tree is displayed.`\n  }\n  , {\n    target: '.top-nav .search-box'\n    , content: `This will allow you to find clades and add them to the tree. You can search by their common name, or (if you know it) scientific name.<br/>Go ahead and give it a try by typing in something like \"Blue Whale\" or \"Platypus\"`\n  }\n]\n\nconst TourCallbacks = {\n  onStart(){\n    this.execStepCallbacks( 0, 'start' )\n  }\n  , execStepCallbacks( step, type ){\n    let currentStep = this.currentStep\n\n    if ( currentStep && currentStep.onLeave ){\n      currentStep.onLeave({ type })\n    }\n\n    if ( step < 0 ){ return }\n\n    currentStep = this.currentStep = TourSteps[ step ]\n    let fn = currentStep.onEnter\n    if ( fn ){\n      fn({ type })\n    }\n  }\n  , onPreviousStep( current ){\n    this.execStepCallbacks( current - 1, 'back' )\n  }\n  , onNextStep( current ){\n    this.execStepCallbacks( current + 1, 'next' )\n  }\n  , onStop(){\n    this.execStepCallbacks( -1, 'stop' )\n  }\n}\n\nexport default {\n  name: 'App'\n  , data: () => ({\n    TourSteps\n    , TourCallbacks\n  })\n  , mounted() {\n    PubSub.$on('tree:move', _throttle(() => {\n      let tour = this.$tours['TOLTour']\n      let step = tour.$children[0]\n      if (!step) { return }\n      step.createStep()\n    }, 500))\n\n    PubSub.$on('tour:start', () => {\n      this.$tours['TOLTour'].start()\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/styles/_variables.scss';\nhtml {\n  height: 100%;\n}\nbody {\n  min-height: 100%;\n  background: white;\n}\n\n#app .v-step {\n  $step-color: saturate(lighten($yellow, 30), 20);\n  $text-color: $blue;\n  z-index: 1000;\n  background: $step-color;\n  color: darken($blue, 20);\n  a {\n    color: $text-color;\n    text-decoration: underline;\n  }\n  .v-step__button {\n    color: $text-color;\n    border-color: $text-color;\n\n    &:hover {\n      background-color: $text-color;\n      color: $step-color;\n    }\n  }\n  &[x-placement^=bottom] .v-step__arrow {\n    border-bottom-color: $step-color;\n  }\n  &[x-placement^=top] .v-step__arrow {\n    border-top-color: $step-color;\n  }\n  &[x-placement^=left] .v-step__arrow {\n    border-left-color: $step-color;\n  }\n  &[x-placement^=right] .v-step__arrow {\n    border-right-color: $step-color;\n  }\n}\n\n#app .main-title {\n  position: relative;\n  margin: 0;\n  margin-right: 1rem;\n  font-weight: 700;\n  color: $blue;\n  text-shadow: 1px 1px 1px lighten($blue, 30);\n\n  font: 0/0 a;\n  background: url(~@/assets/logo-horizontal.png) 0 0 no-repeat;\n  background-size: 100%;\n  width: 150px;\n  height: 150px * (45/166);\n\n  @media screen and (min-width: 820px){\n    width: 250px;\n    height: 250px * (45/166);\n  }\n\n  /* padding-left: 2rem; */\n  /* &:before {\n    content: 'The';\n    position: absolute;\n    top: 3px;\n    left: 0;\n    font-size: 1rem;\n  } */\n}\n\n#app .content .main-title {\n  margin-bottom: 1em;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/app.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_vm._t(\"default\"),_vm._v(\" \"),_c('router-view'),_vm._v(\" \"),_c('v-tour',{attrs:{\"name\":\"TOLTour\",\"steps\":_vm.TourSteps,\"callbacks\":_vm.TourCallbacks}})],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0ee9d958\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/app.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0ee9d958\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./app.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./app.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./app.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0ee9d958\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./app.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app.vue\n// module id = null\n// module chunks = ","import _capitalize from 'lodash/capitalize'\nimport _find from 'lodash/find'\nimport _filter from 'lodash/filter'\n\nfunction titleCase( str ){\n  return str.split(' ').map( w => _capitalize(w) ).join(' ')\n}\n\nconst numberRanges = [\n  { range: [1, 1e3], suffix: '', decimals: 0 }\n  , { range: [1e3, 1e6], suffix: 'k', decimals: 1 }\n  , { range: [1e6, 1e9], suffix: 'M', decimals: 1 }\n  , { range: [1e9, Infinity], suffix: 'B', decimals: 1 }\n]\n\nfunction shortNumber( n ){\n  if ( n === 0 ){\n    return '0'\n  }\n\n  let cfg = _find( numberRanges, cfg => (cfg.range[0] && n < cfg.range[1]) )\n  return (n / cfg.range[0]).toFixed( cfg.decimals ) + cfg.suffix\n}\n\nfunction truncate( str = '', len = 30, sfx = '...' ){\n  if ( str.length < len ){ return str }\n  return str.substr( 0, len - sfx.length ) + sfx\n}\n\nexport default {\n  install( Vue, options ){\n    Vue.filter('capitalize', _capitalize)\n    Vue.filter('titleCase', titleCase)\n    Vue.filter('filter', _filter)\n    Vue.filter('shortNumber', shortNumber)\n    Vue.filter('truncate', truncate)\n\n    Vue.filter('nodeName', function( node ){\n      if (node.taxon){\n        return node.taxon.name\n      }\n      if (node.descendant_name_list){\n        return node.descendant_name_list.join(' and ')\n      }\n      return node.node_id\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/filters.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './app'\nimport router from './router'\nimport Filters from './plugins/filters'\nimport VueMotion from 'vue-motion'\nimport VueTour from 'vue-tour'\nimport VueAwesomeSwiper from 'vue-awesome-swiper'\nimport Buefy from 'buefy'\n\n// require styles\nimport 'swiper/dist/css/swiper.css'\nimport 'vue-tour/dist/vue-tour.css'\nimport './styles/main.scss'\n\nVue.use(Buefy, {\n  defaultContainerElement: '#app .below-nav'\n  // , defaultIconPack: 'fas'\n})\n\nVue.use(Filters)\nVue.use(VueMotion)\nVue.use(VueTour)\nVue.use(VueAwesomeSwiper)\n\nVue.config.productionTip = false\n\nconst MetaInfoComponent = {\n  props: ['show']\n  , template: (function(){\n    let el = document.getElementById('meta-info')\n    let html = el.innerHTML\n    el.parentNode.removeChild(el)\n    return html\n  })()\n  , computed: {\n    showInfo: {\n      get(){\n        return this.show\n      }\n      , set( val ){\n        this.$emit('update:show', val)\n      }\n    }\n  }\n}\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app'\n  , router\n  , data: () => ({\n    showMetaInfo: false\n  })\n  , components: { App, MetaInfoComponent }\n  , template: '<App><MetaInfoComponent :show.sync=\"showMetaInfo\"/></App>'\n  , computed: {\n  }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}